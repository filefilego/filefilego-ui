<template>
    <div id="node-container" style="margin: 0px 10px; border: 1px solid rgb(234, 234, 234); background-color: rgb(255, 255, 255);">
        <div v-if="entryMode">
            <div style="padding-left: 15px; padding-bottom: 15px; padding-top: 15px; padding-right: 15px;"
                class="uk-grid-match" uk-grid>
                <div class="uk-width-expand">
                    <h4 class="modal-header" style="margin-top:10px;">
                        Create entry under: <b style="color:#1e87f0;"> {{ node.name }} </b>
                    </h4>
                </div>
                <div class="k-width-expand uk-text-right">
                    <div>
                        
                    </div>
                </div>
            </div>
            <div style="padding-left: 15px; padding-bottom: 15px; padding-right: 15px;">
                <span class="normal-txt" style="margin-top:10px;">
                       Name:
                </span>
                <div style=" width:100%;" class="uk-inline">
                        <span style="color: #000;" class="uk-form-icon" uk-icon="icon: pencil"></span>
                        <input v-model="entryName" style="width:100%; border-radius: 4px;" class="uk-input normal-txt" type="text" placeholder="Entry Name" aria-label="Input">

                        
                </div>
                <div v-if="validateEntryNameError != ''" style="">
                    <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;" uk-icon="icon: warning;"></span> {{ validateEntryNameError }} </span>
                </div>
            
                <div style="margin-top:10px;">
                    <span class="normal-txt" style="margin-top:10px;">
                           Description:
                    </span>

                    <QuillEditor style="height:300px;" contentType="html" v-model:content="entry_content" :options="toolbarOptions" theme="snow" />
                    
                    <div style="text-align:center; margin-top:10px;" v-if="creatingEntry">
                        <span style="color:#3e15ca;" class="uk-margin-small-right" uk-spinner="ratio: 1"></span>
                    </div>

                    <div v-if="createEntryError != ''" style="margin-top:10px;">
                        <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;"
                                uk-icon="icon: warning;"></span> {{ createEntryError }} </span>
                    </div>

                    <div v-if="!creatingEntry" style="margin-top:10px; text-align: center;">
                        <button @click="goBack" class="uk-button" style="text-transform: none; width:150px; height:40px;margin-right:20px; ">
                            Back
                            <span class="uk-icon" uk-icon="icon:  arrow-left"></span>
                        </button>
                        <button @click="createEntry" class="uk-button ffg-button" style="width:150px; height:40px; ">
                                    Create
                            <span class="uk-icon" uk-icon="icon: plus"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div v-else>
            <div style="padding-left: 15px; padding-bottom: 15px; padding-top: 15px; padding-right: 15px;"
                class="uk-grid-match" uk-grid>
                <div class="uk-width-expand">
                    <h4 style="color: rgb(13, 13, 13);  font-weight: 700; margin-top:10px;">
                        {{ node.name }}
                    </h4>
                </div>
                <div class="k-width-expand uk-text-right">
                    <div v-show="canCreate && node.node_type < 5">
                        <div>
                            <button class="uk-button ffg-button" style="width:150px; height:40px; ">
                                New
                                <span class="uk-icon" uk-icon="icon: plus"></span>
                            </button>

                            <div @click="hideNav" id="new_dropdown"
                                style="background-color:white; border:1px solid #e3e3e3; text-align: left;"
                                uk-dropdown="mode: click; delay-hide:0;">
                                <ul style="padding:0px; margin:0px;" class="chan-action-ul uk-list">
                                    <li v-if="node.node_type == 1 || node.node_type == 2" @click="openCreateSubChannelModal" class="clickable">
                                        <span uk-icon="icon:thumbnails;"></span> Subchannel
                                    </li>
                                    <li v-if="node.node_type == 1 || node.node_type == 2" @click="openEntryModal" class="clickable">
                                        <span uk-icon="icon:pencil;"></span> Entry
                                    </li>
                                    <li @click="openNewFolderModal" class="clickable">
                                        <span uk-icon="icon:folder;"></span> Folder
                                    </li>
                                    <li v-if="node.node_type < 5" @click="openUploadModal" class="clickable">
                                        <span uk-icon="icon:upload;"></span> Upload
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="uk-text-center">
                <div v-if="loadingNode" style="padding:0px 10px; text-align: center;">
                    <div style="border:1px solid #d7d7d7; border-radius: 2px;">
                        <div style="margin-top:50px;">
                            <span class="app-header2">Loading page</span>
                        </div>
                        <div style="margin-top:18px; padding-bottom:30px;">
                            <div style="margin-top:35px;">
                                <div class="uk-margin">
                                    <span class="uk-margin-small-right" uk-spinner="ratio: 3"></span>
                                </div>
                                <span class="normal-txt">Please wait while we load the page</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-else>
                    <div v-if="node.node_hash == ''" style="padding:0px 10px; text-align: center;">
                        <div style="border:1px solid #d7d7d7; border-radius: 2px;">
                            <div style="margin-top:50px;">
                                <span class="app-header2">Channel item was not
                                    found</span>
                            </div>
                            <div style="margin-top:18px; padding-bottom:30px;">
                                <div style="margin-top:35px;">
                                    <div class="uk-margin">
                                        <svg style="vertical-align:middle;" xmlns="http://www.w3.org/2000/svg"
                                            height="110px" width="110px" fill="#3e15ca" data-name="Layer 1"
                                            viewBox="0 0 100 100" x="0px" y="0px">
                                            <title> </title>
                                            <path
                                                d="M90,39a4,4,0,0,0-3.86,3H83v8.36l-3.11-3.11L66.38,52.13l-3.17,8.79L54,56.6l-8.62,4,4-8.07-4.53-5.72L51.73,40h5.41a4,4,0,1,0,0-2H50.9l-7.29,7.29-3.14-4-7.34-.17,2.89-8-4.28-4.28L39.63,21H50.14a4,4,0,1,0,0-2H38.81l-8.48,8.48L27,24.15V13H37.14a4,4,0,1,0,0-2H25V24L12.85,28.38,8,41.89l9.66,9.66,3.94-1.42L20,53.24l4.31,5.44L19,64H12.86a4,4,0,1,0,0,2h7l5.74-5.74L29,64.49l12,.27V70H30.86a4,4,0,1,0,0,2H41v4.37l5,2.35V82H37.86a4,4,0,1,0,0,2H48V79.66l6,2.81,6-2.81V87H76.14a4,4,0,1,0,0-2H62V78.72l5-2.35V71.12l4.17,4.17,13.5-4.87,4.88-13.51L85,52.36V44h1.14A4,4,0,1,0,90,39ZM61,37a2,2,0,1,1-2,2A2,2,0,0,1,61,37ZM54,18a2,2,0,1,1-2,2A2,2,0,0,1,54,18ZM41,10a2,2,0,1,1-2,2A2,2,0,0,1,41,10ZM9,67a2,2,0,1,1,2-2A2,2,0,0,1,9,67Zm18,6a2,2,0,1,1,2-2A2,2,0,0,1,27,73Zm7,12a2,2,0,1,1,2-2A2,2,0,0,1,34,85Zm46-1a2,2,0,1,1-2,2A2,2,0,0,1,80,84ZM68,53.69l9.91-3.58L74,59.7l-7.56,2.73L65,61.78ZM65,65.07v1.22l-.9-.9Zm-2.47-2.26L62.1,64l-7.83,3.32L45.06,63,54,58.81Zm-23-19.51L46,51.57l-10.33-.63-4.19-5.29.9-2.5Zm-10-.22.83,0-.26.71Zm-.94,2.41-2.95,1.06,1.34-2.68ZM31,41.12,26.91,41l-4.52-4.51,4.07-10.07,7.25,7.25ZM14.42,30l9.91-3.58L20.46,36,11,39.36Zm3.74,19.29-7.59-7.59L21,37.9l4.48,4.48-2.57,5.15Zm6.14-.1,5.78-2.08,4,5-4.78,9.6L22.39,53ZM31,62.54,35.81,53l10.84.66L42.46,62,41,62.7v.06ZM43,64.8h.31l.17-.34L53,68.94V79.79L43,75.1ZM65,75.1,55,79.79V69.19l7.07-3L65,69.12Zm2-6.81v-4l7.49-2.7,7.58,7.59L71.69,73Zm16.49-.47-7.57-7.57L80,50.18l7.25,7.25ZM90,45a2,2,0,1,1,2-2A2,2,0,0,1,90,45Z" />
                                        </svg>
                                    </div>
                                    <span class="normal-txt">
                                        This page was not found, please go to the Channels section and create a channel.
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div v-else style="text-align:left; text-transform: none;">
                        <div v-if="node.node_type == 1 || node.node_type == 2">
                            <div
                                style="text-align: center; background-color: rgb(245, 245, 245); padding:20px; border-top: 1px solid rgb(234, 234, 234);">
                                <div
                                    style=" background-color: #3e15ca; margin: 0px auto;width: 64px;font-weight: 600;color: white;font-size: 2.5em;text-align: center;border-radius: 50%;height: 64px; ">
                                    <span style="display:inline-block; margin-top:2px;"> {{
                                        $filters.firstletter(node.name) }} </span>
                                </div>
                                <div style="padding:10px;">
                                    <span style="color:#000;">
                                        {{ node.description }}
                                    </span>
                                </div>
                            </div>
                            <div v-if="subchannels.length > 0 || node.node_type == 1"
                                style="border-top: 1px solid rgb(234, 234, 234); padding-left: 15px; padding-bottom: 15px; padding-top: 15px; padding-right: 15px;">
                                <h4
                                    style="color: rgb(13, 13, 13);  font-weight: 700; padding-top:5px; padding-bottom:5px; margin:0px;">
                                    Subchannels
                                </h4>
                                <table style="margin:0px;" class="uk-table uk-table-divider">
                                    <tbody>
                                        <tr v-for="(ch) in subchannels" :key="ch.node_hash">
                                            <td style="width: 34px; vertical-align: middle">
                                                <div v-if="ch.node_type <= 2"
                                                    style=" background-color: #000; margin: 0px auto;width: 32px;font-weight: 600;color: white;font-size: 1.2em;text-align: center;border-radius: 4px;height: 32px; ">
                                                    <span style="display:inline-block; margin-top:2px;"> {{
                                                        $filters.firstletter(ch.name) }} </span>
                                                </div>
                                                <div v-if="ch.node_type == 3"
                                                    style=" background-color: #3e15ca; margin: 0px auto;width: 32px;font-weight: 600;color: white;font-size: 1.2em;text-align: center;border-radius: 4px;height: 32px; ">
                                                    <span style="display:inline-block; margin-top:2px;"> {{
                                                        $filters.firstletter(ch.name) }} </span>
                                                </div>
                                                <img v-if="ch.node_type==4" src="/assets/folder.png" />
                                                <img v-if="ch.node_type==5" :src="nodeVector(ch.name)" />
                                            </td>
                                            <td>
                                                <div style="text-align: left; vertical-align: middle; padding-top:5px;">
                                                    <router-link style="font-weight: bold"
                                                        :to="'/channels/node/' + ch.node_hash"> {{ ch.name }}</router-link>
                                                    <div v-if="ch.description != '' && ch.node_type <= 2 " style="font-size: 0.9em; padding: 0; margin: 0">
                                                        {{ ch.description }}
                                                    </div>
                                                </div>
                                            </td>
                                            <td style="vertical-align: middle; text-align:right;">
                                                <div class="normal-txt">{{ $filters.timestamptodate(ch.timestamp) }}</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div v-if="subchannels.length == 0 && otherChannelNodes.length == 0"
                                    style="text-align: center;">
                                    <span style="color:#000; font-weight: bold;">
                                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                            width="80pt" height="80pt" version="1.1" viewBox="0 0 700 700">
                                            <defs>
                                                <symbol id="w" overflow="visible">
                                                    <path
                                                        d="m18.766-1.125c-0.96875 0.5-1.9805 0.875-3.0312 1.125-1.043 0.25781-2.1367 0.39062-3.2812 0.39062-3.3984 0-6.0898-0.94531-8.0781-2.8438-1.9922-1.9062-2.9844-4.4844-2.9844-7.7344 0-3.2578 0.99219-5.8359 2.9844-7.7344 1.9883-1.9062 4.6797-2.8594 8.0781-2.8594 1.1445 0 2.2383 0.13281 3.2812 0.39062 1.0508 0.25 2.0625 0.625 3.0312 1.125v4.2188c-0.98047-0.65625-1.9453-1.1406-2.8906-1.4531-0.94922-0.3125-1.9492-0.46875-3-0.46875-1.875 0-3.3516 0.60547-4.4219 1.8125-1.0742 1.1992-1.6094 2.8555-1.6094 4.9688 0 2.1055 0.53516 3.7617 1.6094 4.9688 1.0703 1.1992 2.5469 1.7969 4.4219 1.7969 1.0508 0 2.0508-0.14844 3-0.45312 0.94531-0.3125 1.9102-0.80078 2.8906-1.4688z" />
                                                </symbol>
                                                <symbol id="d" overflow="visible">
                                                    <path
                                                        d="m13.734-11.141c-0.4375-0.19531-0.87109-0.34375-1.2969-0.4375-0.41797-0.10156-0.83984-0.15625-1.2656-0.15625-1.2617 0-2.2305 0.40625-2.9062 1.2188-0.67969 0.80469-1.0156 1.9531-1.0156 3.4531v7.0625h-4.8906v-15.312h4.8906v2.5156c0.625-1 1.3438-1.7266 2.1562-2.1875 0.82031-0.46875 1.8008-0.70312 2.9375-0.70312 0.16406 0 0.34375 0.011719 0.53125 0.03125 0.19531 0.011719 0.47656 0.039062 0.84375 0.078125z" />
                                                </symbol>
                                                <symbol id="b" overflow="visible">
                                                    <path
                                                        d="m17.641-7.7031v1.4062h-11.453c0.125 1.1484 0.53906 2.0078 1.25 2.5781 0.70703 0.57422 1.7031 0.85938 2.9844 0.85938 1.0312 0 2.082-0.14844 3.1562-0.45312 1.082-0.3125 2.1914-0.77344 3.3281-1.3906v3.7656c-1.1562 0.4375-2.3125 0.76562-3.4688 0.98438-1.1562 0.22656-2.3125 0.34375-3.4688 0.34375-2.7734 0-4.9297-0.70312-6.4688-2.1094-1.5312-1.4062-2.2969-3.3789-2.2969-5.9219 0-2.5 0.75391-4.4609 2.2656-5.8906 1.5078-1.4375 3.582-2.1562 6.2188-2.1562 2.4062 0 4.332 0.73047 5.7812 2.1875 1.4453 1.4492 2.1719 3.3828 2.1719 5.7969zm-5.0312-1.625c0-0.92578-0.27344-1.6719-0.8125-2.2344-0.54297-0.57031-1.25-0.85938-2.125-0.85938-0.94922 0-1.7188 0.26562-2.3125 0.79688s-0.96484 1.2969-1.1094 2.2969z" />
                                                </symbol>
                                                <symbol id="j" overflow="visible">
                                                    <path
                                                        d="m9.2188-6.8906c-1.0234 0-1.793 0.17188-2.3125 0.51562-0.51172 0.34375-0.76562 0.85547-0.76562 1.5312 0 0.625 0.20703 1.1172 0.625 1.4688 0.41406 0.34375 0.98828 0.51562 1.7188 0.51562 0.92578 0 1.7031-0.32812 2.3281-0.98438 0.63281-0.66406 0.95312-1.4922 0.95312-2.4844v-0.5625zm7.4688-1.8438v8.7344h-4.9219v-2.2656c-0.65625 0.92969-1.3984 1.6055-2.2188 2.0312-0.82422 0.41406-1.8242 0.625-3 0.625-1.5859 0-2.8711-0.45703-3.8594-1.375-0.99219-0.92578-1.4844-2.1289-1.4844-3.6094 0-1.7891 0.61328-3.1016 1.8438-3.9375 1.2383-0.84375 3.1797-1.2656 5.8281-1.2656h2.8906v-0.39062c0-0.76953-0.30859-1.332-0.92188-1.6875-0.61719-0.36328-1.5703-0.54688-2.8594-0.54688-1.0547 0-2.0312 0.10547-2.9375 0.3125-0.89844 0.21094-1.7305 0.52344-2.5 0.9375v-3.7344c1.0391-0.25 2.0859-0.44141 3.1406-0.57812 1.0625-0.13281 2.125-0.20312 3.1875-0.20312 2.7578 0 4.75 0.54688 5.9688 1.6406 1.2266 1.0859 1.8438 2.8555 1.8438 5.3125z" />
                                                </symbol>
                                                <symbol id="c" overflow="visible">
                                                    <path
                                                        d="m7.7031-19.656v4.3438h5.0469v3.5h-5.0469v6.5c0 0.71094 0.14062 1.1875 0.42188 1.4375s0.83594 0.375 1.6719 0.375h2.5156v3.5h-4.1875c-1.9375 0-3.3125-0.39844-4.125-1.2031-0.80469-0.8125-1.2031-2.1797-1.2031-4.1094v-6.5h-2.4219v-3.5h2.4219v-4.3438z" />
                                                </symbol>
                                                <symbol id="i" overflow="visible">
                                                    <path
                                                        d="m12.766-13.078v-8.2031h4.9219v21.281h-4.9219v-2.2188c-0.66797 0.90625-1.4062 1.5703-2.2188 1.9844s-1.7578 0.625-2.8281 0.625c-1.8867 0-3.4336-0.75-4.6406-2.25-1.2109-1.5-1.8125-3.4258-1.8125-5.7812 0-2.3633 0.60156-4.2969 1.8125-5.7969 1.207-1.5 2.7539-2.25 4.6406-2.25 1.0625 0 2 0.21484 2.8125 0.64062 0.82031 0.42969 1.5664 1.0859 2.2344 1.9688zm-3.2188 9.9219c1.0391 0 1.8359-0.37891 2.3906-1.1406 0.55078-0.76953 0.82812-1.8828 0.82812-3.3438 0-1.457-0.27734-2.5664-0.82812-3.3281-0.55469-0.76953-1.3516-1.1562-2.3906-1.1562-1.043 0-1.8398 0.38672-2.3906 1.1562-0.55469 0.76172-0.82812 1.8711-0.82812 3.3281 0 1.4609 0.27344 2.5742 0.82812 3.3438 0.55078 0.76172 1.3477 1.1406 2.3906 1.1406z" />
                                                </symbol>
                                                <symbol id="f" overflow="visible">
                                                    <path
                                                        d="m10.5-3.1562c1.0508 0 1.8516-0.37891 2.4062-1.1406 0.55078-0.76953 0.82812-1.8828 0.82812-3.3438 0-1.457-0.27734-2.5664-0.82812-3.3281-0.55469-0.76953-1.3555-1.1562-2.4062-1.1562-1.0547 0-1.8594 0.38672-2.4219 1.1562-0.55469 0.77344-0.82812 1.8828-0.82812 3.3281 0 1.4492 0.27344 2.5586 0.82812 3.3281 0.5625 0.77344 1.3672 1.1562 2.4219 1.1562zm-3.25-9.9219c0.67578-0.88281 1.4219-1.5391 2.2344-1.9688 0.82031-0.42578 1.7656-0.64062 2.8281-0.64062 1.8945 0 3.4453 0.75 4.6562 2.25 1.207 1.5 1.8125 3.4336 1.8125 5.7969 0 2.3555-0.60547 4.2812-1.8125 5.7812-1.2109 1.5-2.7617 2.25-4.6562 2.25-1.0625 0-2.0078-0.21094-2.8281-0.625-0.8125-0.42578-1.5586-1.0859-2.2344-1.9844v2.2188h-4.8906v-21.281h4.8906z" />
                                                </symbol>
                                                <symbol id="e" overflow="visible">
                                                    <path
                                                        d="m0.34375-15.312h4.8906l4.125 10.391 3.5-10.391h4.8906l-6.4375 16.766c-0.64844 1.6953-1.4023 2.8828-2.2656 3.5625-0.86719 0.6875-2 1.0312-3.4062 1.0312h-2.8438v-3.2188h1.5312c0.83203 0 1.4375-0.13672 1.8125-0.40625 0.38281-0.26172 0.67969-0.73047 0.89062-1.4062l0.14062-0.42188z" />
                                                </symbol>
                                                <symbol id="h" overflow="visible">
                                                    <path
                                                        d="m16.781-19.766v4.3125c-1.125-0.5-2.2266-0.875-3.2969-1.125-1.0625-0.25781-2.0703-0.39062-3.0156-0.39062-1.25 0-2.1797 0.17969-2.7812 0.53125-0.60547 0.34375-0.90625 0.88281-0.90625 1.6094 0 0.54297 0.20312 0.96875 0.60938 1.2812 0.40625 0.30469 1.1406 0.5625 2.2031 0.78125l2.25 0.45312c2.2695 0.44922 3.8789 1.1406 4.8281 2.0781 0.95703 0.92969 1.4375 2.2461 1.4375 3.9531 0 2.25-0.66797 3.9297-2 5.0312-1.3359 1.0938-3.3711 1.6406-6.1094 1.6406-1.3047 0-2.6055-0.125-3.9062-0.375-1.3047-0.23828-2.6055-0.59766-3.9062-1.0781v-4.4531c1.3008 0.69922 2.5625 1.2266 3.7812 1.5781 1.2188 0.34375 2.3906 0.51562 3.5156 0.51562 1.1562 0 2.0352-0.1875 2.6406-0.5625 0.61328-0.38281 0.92188-0.9375 0.92188-1.6562 0-0.63281-0.21094-1.125-0.625-1.4688-0.41797-0.34375-1.2461-0.65625-2.4844-0.9375l-2.0312-0.4375c-2.043-0.4375-3.5391-1.1328-4.4844-2.0938-0.9375-0.95703-1.4062-2.25-1.4062-3.875 0-2.0312 0.65625-3.5938 1.9688-4.6875s3.1953-1.6406 5.6562-1.6406c1.125 0 2.2734 0.085938 3.4531 0.25 1.1875 0.16797 2.4141 0.42188 3.6875 0.76562z" />
                                                </symbol>
                                                <symbol id="a" overflow="visible">
                                                    <path
                                                        d="m9.6406-12.188c-1.0859 0-1.9141 0.39062-2.4844 1.1719-0.57422 0.78125-0.85938 1.9062-0.85938 3.375s0.28516 2.5938 0.85938 3.375c0.57031 0.77344 1.3984 1.1562 2.4844 1.1562 1.0625 0 1.875-0.38281 2.4375-1.1562 0.57031-0.78125 0.85938-1.9062 0.85938-3.375s-0.28906-2.5938-0.85938-3.375c-0.5625-0.78125-1.375-1.1719-2.4375-1.1719zm0-3.5c2.6328 0 4.6914 0.71484 6.1719 2.1406 1.4766 1.418 2.2188 3.3867 2.2188 5.9062 0 2.5117-0.74219 4.4805-2.2188 5.9062-1.4805 1.418-3.5391 2.125-6.1719 2.125-2.6484 0-4.7148-0.70703-6.2031-2.125-1.4922-1.4258-2.2344-3.3945-2.2344-5.9062 0-2.5195 0.74219-4.4883 2.2344-5.9062 1.4883-1.4258 3.5547-2.1406 6.2031-2.1406z" />
                                                </symbol>
                                                <symbol id="v" overflow="visible">
                                                    <path
                                                        d="m14.953-3.7188h-8.2188l-1.3125 3.7188h-5.2812l7.5625-20.406h6.2656l7.5625 20.406h-5.2812zm-6.9062-3.7812h5.5781l-2.7812-8.125z" />
                                                </symbol>
                                                <symbol id="g" overflow="visible">
                                                    <path
                                                        d="m2.3594-15.312h4.8906v15.312h-4.8906zm0-5.9688h4.8906v4h-4.8906z" />
                                                </symbol>
                                                <symbol id="u" overflow="visible">
                                                    <path
                                                        d="m0.82812-20.406h5.0469l3.5312 14.828 3.5-14.828h5.0781l3.5 14.828 3.5156-14.828h5.0156l-4.8125 20.406h-6.0781l-3.7031-15.516-3.6562 15.516h-6.0781z" />
                                                </symbol>
                                                <symbol id="t" overflow="visible">
                                                    <path
                                                        d="m0.98438-15.312h4.7656l2.5625 10.547 2.5781-10.547h4.0938l2.5781 10.438 2.5781-10.438h4.75l-4.0312 15.312h-5.3438l-2.5781-10.531-2.5781 10.531h-5.3438z" />
                                                </symbol>
                                                <symbol id="s" overflow="visible">
                                                    <path
                                                        d="m12.422-21.281v3.2188h-2.7031c-0.6875 0-1.1719 0.125-1.4531 0.375-0.27344 0.25-0.40625 0.6875-0.40625 1.3125v1.0625h4.1875v3.5h-4.1875v11.812h-4.8906v-11.812h-2.4375v-3.5h2.4375v-1.0625c0-1.6641 0.46094-2.8984 1.3906-3.7031 0.92578-0.80078 2.3672-1.2031 4.3281-1.2031z" />
                                                </symbol>
                                                <symbol id="r" overflow="visible">
                                                    <path
                                                        d="m16.547-12.766c0.61328-0.94531 1.3477-1.6719 2.2031-2.1719 0.85156-0.5 1.7891-0.75 2.8125-0.75 1.7578 0 3.0977 0.54688 4.0156 1.6406 0.92578 1.0859 1.3906 2.6562 1.3906 4.7188v9.3281h-4.9219v-7.9844-0.35938c0.007813-0.13281 0.015625-0.32031 0.015625-0.5625 0-1.082-0.16406-1.8633-0.48438-2.3438-0.3125-0.48828-0.82422-0.73438-1.5312-0.73438-0.92969 0-1.6484 0.38672-2.1562 1.1562-0.51172 0.76172-0.77344 1.8672-0.78125 3.3125v7.5156h-4.9219v-7.9844c0-1.6953-0.14844-2.7852-0.4375-3.2656-0.29297-0.48828-0.8125-0.73438-1.5625-0.73438-0.9375 0-1.6641 0.38672-2.1719 1.1562-0.51172 0.76172-0.76562 1.8594-0.76562 3.2969v7.5312h-4.9219v-15.312h4.9219v2.2344c0.60156-0.86328 1.2891-1.5156 2.0625-1.9531 0.78125-0.4375 1.6406-0.65625 2.5781-0.65625 1.0625 0 2 0.25781 2.8125 0.76562 0.8125 0.51172 1.4258 1.2305 1.8438 2.1562z" />
                                                </symbol>
                                                <symbol id="q" overflow="visible">
                                                    <path
                                                        d="m17.75-9.3281v9.3281h-4.9219v-7.1094c0-1.3438-0.03125-2.2656-0.09375-2.7656s-0.16797-0.86719-0.3125-1.1094c-0.1875-0.3125-0.44922-0.55469-0.78125-0.73438-0.32422-0.17578-0.69531-0.26562-1.1094-0.26562-1.0234 0-1.8242 0.39844-2.4062 1.1875-0.58594 0.78125-0.875 1.8711-0.875 3.2656v7.5312h-4.8906v-21.281h4.8906v8.2031c0.73828-0.88281 1.5195-1.5391 2.3438-1.9688 0.83203-0.42578 1.75-0.64062 2.75-0.64062 1.7695 0 3.1133 0.54688 4.0312 1.6406 0.91406 1.0859 1.375 2.6562 1.375 4.7188z" />
                                                </symbol>
                                                <symbol id="p" overflow="visible">
                                                    <path
                                                        d="m2.5781-20.406h5.875l7.4219 14v-14h4.9844v20.406h-5.875l-7.4219-14v14h-4.9844z" />
                                                </symbol>
                                                <symbol id="o" overflow="visible">
                                                    <path
                                                        d="m2.1875-5.9688v-9.3438h4.9219v1.5312c0 0.83594-0.007813 1.875-0.015625 3.125-0.011719 1.25-0.015625 2.0859-0.015625 2.5 0 1.2422 0.03125 2.1328 0.09375 2.6719 0.070313 0.54297 0.17969 0.93359 0.32812 1.1719 0.20703 0.32422 0.47266 0.57422 0.79688 0.75 0.32031 0.16797 0.69141 0.25 1.1094 0.25 1.0195 0 1.8203-0.39062 2.4062-1.1719 0.58203-0.78125 0.875-1.8672 0.875-3.2656v-7.5625h4.8906v15.312h-4.8906v-2.2188c-0.74219 0.89844-1.5234 1.5586-2.3438 1.9844-0.82422 0.41406-1.7344 0.625-2.7344 0.625-1.7617 0-3.1055-0.53906-4.0312-1.625-0.92969-1.082-1.3906-2.6602-1.3906-4.7344z" />
                                                </symbol>
                                                <symbol id="n" overflow="visible">
                                                    <path
                                                        d="m17.75-9.3281v9.3281h-4.9219v-7.1406c0-1.3203-0.03125-2.2344-0.09375-2.7344s-0.16797-0.86719-0.3125-1.1094c-0.1875-0.3125-0.44922-0.55469-0.78125-0.73438-0.32422-0.17578-0.69531-0.26562-1.1094-0.26562-1.0234 0-1.8242 0.39844-2.4062 1.1875-0.58594 0.78125-0.875 1.8711-0.875 3.2656v7.5312h-4.8906v-15.312h4.8906v2.2344c0.73828-0.88281 1.5195-1.5391 2.3438-1.9688 0.83203-0.42578 1.75-0.64062 2.75-0.64062 1.7695 0 3.1133 0.54688 4.0312 1.6406 0.91406 1.0859 1.375 2.6562 1.375 4.7188z" />
                                                </symbol>
                                                <symbol id="m" overflow="visible">
                                                    <path
                                                        d="m2.5781-20.406h8.7344c2.5938 0 4.582 0.57812 5.9688 1.7344 1.3945 1.1484 2.0938 2.7891 2.0938 4.9219 0 2.1367-0.69922 3.7812-2.0938 4.9375-1.3867 1.1562-3.375 1.7344-5.9688 1.7344h-3.4844v7.0781h-5.25zm5.25 3.8125v5.7031h2.9219c1.0195 0 1.8047-0.25 2.3594-0.75 0.5625-0.5 0.84375-1.2031 0.84375-2.1094 0-0.91406-0.28125-1.6172-0.84375-2.1094-0.55469-0.48828-1.3398-0.73438-2.3594-0.73438z" />
                                                </symbol>
                                                <symbol id="l" overflow="visible">
                                                    <path
                                                        d="m2.3594-15.312h4.8906v15.031c0 2.0508-0.49609 3.6172-1.4844 4.7031-0.98047 1.082-2.4062 1.625-4.2812 1.625h-2.4219v-3.2188h0.85938c0.92578 0 1.5625-0.21094 1.9062-0.625 0.35156-0.41797 0.53125-1.2461 0.53125-2.4844zm0-5.9688h4.8906v4h-4.8906z" />
                                                </symbol>
                                                <symbol id="k" overflow="visible">
                                                    <path
                                                        d="m14.719-14.828v3.9844c-0.65625-0.45703-1.3242-0.79688-2-1.0156-0.66797-0.21875-1.3594-0.32812-2.0781-0.32812-1.3672 0-2.4336 0.40234-3.2031 1.2031-0.76172 0.79297-1.1406 1.9062-1.1406 3.3438 0 1.4297 0.37891 2.543 1.1406 3.3438 0.76953 0.79297 1.8359 1.1875 3.2031 1.1875 0.75781 0 1.4844-0.10938 2.1719-0.32812 0.6875-0.22656 1.3203-0.56641 1.9062-1.0156v4c-0.76172 0.28125-1.5391 0.48828-2.3281 0.625-0.78125 0.14453-1.5742 0.21875-2.375 0.21875-2.7617 0-4.9219-0.70703-6.4844-2.125-1.5547-1.4141-2.3281-3.3828-2.3281-5.9062 0-2.5312 0.77344-4.5039 2.3281-5.9219 1.5625-1.4141 3.7227-2.125 6.4844-2.125 0.80078 0 1.5938 0.074219 2.375 0.21875 0.78125 0.13672 1.5547 0.35156 2.3281 0.64062z" />
                                                </symbol>
                                            </defs>
                                            <g>
                                                <path
                                                    d="m514.64 358.96c-13.965-7.9805-32.613-5.2852-43.121 7.8398l-61.039-35.281h-0.55859c3.9219-8.9648 6.7188-18.48 6.7188-28.566 0-35.281-27.441-63.836-61.602-66.633v-0.55859-71.121c15.68-2.8008 28-16.238 28-33.039 0-18.48-15.121-33.602-33.602-33.602s-33.602 15.121-33.602 33.602c0 16.801 12.32 30.238 28 33.039l0.003906 70.559v0.55859c-34.719 2.8008-61.602 31.922-61.602 66.641 0 10.078 2.2383 20.16 6.7188 28.559h-0.55859l-61.039 35.281c-10.84-13.547-29.637-15.547-43.121-7.8398-16.238 9.5195-21.84 29.68-12.32 45.922 7.6328 13.184 25.273 22.645 45.922 12.32 14.559-8.4023 20.16-25.762 14.559-40.879l61.039-35.281c13.441 17.918 33.602 29.121 56.562 29.121s43.121-11.199 55.441-29.121l61.039 35.281c-5.6016 15.121 0 32.484 14.566 40.887 17.062 9.4805 36.961 3.1523 45.914-12.32 9.5195-15.688 3.918-36.406-12.32-45.367zm-301.28 48.16c-10.641 6.1602-24.641 2.2344-30.801-8.3984-6.1602-10.641-2.2383-24.641 8.3984-30.801 9.1719-6.1211 24.668-2.7383 30.238 8.3984 6.7266 11.199 2.8047 24.641-7.8359 30.801zm114.24-275.52c0-12.32 10.078-22.398 22.398-22.398s22.398 10.078 22.398 22.398c0 12.32-10.078 22.398-22.398 22.398s-22.398-10.078-22.398-22.398zm22.398 226.8c-30.801 0-56-25.199-56-56 0-30.801 25.199-56 56-56s56 25.199 56 56c0 30.801-25.199 56-56 56zm167.44 40.883c-6.1602 10.641-20.16 14.559-30.801 8.3984-10.641-6.1602-14.566-20.16-8.3984-30.801 5.6523-10.164 18.484-14.93 30.234-8.3984 11.203 6.1602 15.125 19.598 8.9648 30.801z" />
                                            </g>
                                        </svg>
                                        <br />
                                        There are no subchannels yet
                                    </span>
                                </div>
                            </div>

                            <div
                                style="border-top: 1px solid rgb(234, 234, 234); padding-left: 15px; padding-bottom: 15px; padding-top: 15px; padding-right: 15px;">
                                <h4
                                    style="color: rgb(13, 13, 13);  font-weight: 700; padding-top:5px; padding-bottom:5px; margin:0px;">
                                    Data
                                </h4>
                                <table style="margin:0px;" class="uk-table uk-table-divider">
                                    <tbody>
                                        <tr v-for="(ch) in otherChannelNodes" :key="ch.node_hash">
                                            <td style="width: 34px; vertical-align: middle">
                                                <div v-if="ch.node_type <= 2"
                                                    style=" background-color: #000; margin: 0px auto;width: 32px;font-weight: 600;color: white;font-size: 1.2em;text-align: center;border-radius: 4px;height: 32px; ">
                                                    <span style="display:inline-block; margin-top:2px;"> {{
                                                        $filters.firstletter(ch.name) }} </span>
                                                </div>
                                                <div v-if="ch.node_type == 3"
                                                    style=" background-color: #3e15ca; margin: 0px auto;width: 32px;font-weight: 600;color: white;font-size: 1.2em;text-align: center;border-radius: 4px;height: 32px; ">
                                                    <span style="display:inline-block; margin-top:2px;"> {{
                                                        $filters.firstletter(ch.name) }} </span>
                                                </div>
                                                <img v-if="ch.node_type==4" src="/assets/folder.png" />
                                                <img v-if="ch.node_type==5" :src="nodeVector(ch.name)" />
                                            </td>
                                            <td>
                                                <div style="text-align: left; vertical-align: middle; padding-top:5px;">
                                                    <router-link style="font-weight: bold"
                                                        :to="'/channels/node/' + ch.node_hash"> {{ ch.name }}</router-link>
                                                    <div v-if="ch.description != '' && ch.node_type <= 2 " style="font-size: 0.9em; padding: 0; margin: 0">
                                                        {{ ch.description }}
                                                    </div>
                                                </div>
                                            </td>
                                            <td style="vertical-align: middle; text-align:right;">
                                                <div class="normal-txt">{{ $filters.timestamptodate(ch.timestamp) }}</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div v-if="otherChannelNodes.length == 0" style="text-align: center;">
                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        width="80pt" height="80pt" version="1.1" viewBox="0 0 700 700">
                                        <defs>
                                            <symbol id="s" overflow="visible">
                                                <path
                                                    d="m19.547-1.1719c-1.0117 0.52344-2.0625 0.91406-3.1562 1.1719-1.0938 0.26953-2.2344 0.40625-3.4219 0.40625-3.543 0-6.3516-0.98828-8.4219-2.9688-2.0625-1.9766-3.0938-4.6602-3.0938-8.0469 0-3.4062 1.0312-6.0977 3.0938-8.0781 2.0703-1.9766 4.8789-2.9688 8.4219-2.9688 1.1875 0 2.3281 0.13672 3.4219 0.40625 1.0938 0.26172 2.1445 0.65625 3.1562 1.1875v4.3906c-1.0234-0.6875-2.0273-1.1914-3.0156-1.5156-0.98047-0.32031-2.0156-0.48438-3.1094-0.48438-1.9609 0-3.5 0.625-4.625 1.875-1.1172 1.25-1.6719 2.9805-1.6719 5.1875 0 2.1875 0.55469 3.9141 1.6719 5.1719 1.125 1.25 2.6641 1.875 4.625 1.875 1.0938 0 2.1289-0.16016 3.1094-0.48438 0.98828-0.32031 1.9922-0.82812 3.0156-1.5156z" />
                                            </symbol>
                                            <symbol id="b" overflow="visible">
                                                <path
                                                    d="m14.297-11.609c-0.44922-0.20703-0.89062-0.35938-1.3281-0.45312-0.4375-0.10156-0.88281-0.15625-1.3281-0.15625-1.3125 0-2.3242 0.42188-3.0312 1.2656-0.71094 0.83594-1.0625 2.0391-1.0625 3.6094v7.3438h-5.0938v-15.953h5.0938v2.625c0.65625-1.0508 1.4062-1.8164 2.25-2.2969 0.85156-0.47656 1.875-0.71875 3.0625-0.71875 0.17578 0 0.36328 0.011719 0.5625 0.03125 0.19531 0.011719 0.48438 0.042969 0.85938 0.09375z" />
                                            </symbol>
                                            <symbol id="a" overflow="visible">
                                                <path
                                                    d="m18.375-8.0156v1.4531h-11.922c0.125 1.1992 0.55469 2.0938 1.2969 2.6875 0.73828 0.59375 1.7734 0.89062 3.1094 0.89062 1.0703 0 2.1719-0.15625 3.2969-0.46875 1.125-0.32031 2.2812-0.80469 3.4688-1.4531v3.9375c-1.2109 0.46094-2.418 0.80469-3.625 1.0312-1.2109 0.22656-2.4141 0.34375-3.6094 0.34375-2.8984 0-5.1484-0.72656-6.75-2.1875-1.5938-1.4688-2.3906-3.5312-2.3906-6.1875 0-2.5938 0.78516-4.6328 2.3594-6.125 1.5703-1.5 3.7344-2.25 6.4844-2.25 2.5078 0 4.5156 0.75781 6.0156 2.2656 1.5078 1.5117 2.2656 3.5312 2.2656 6.0625zm-5.2344-1.7031c0-0.96875-0.28906-1.75-0.85938-2.3438-0.5625-0.59375-1.2969-0.89062-2.2031-0.89062-0.99219 0-1.7969 0.28125-2.4219 0.84375-0.61719 0.55469-0.99609 1.3516-1.1406 2.3906z" />
                                            </symbol>
                                            <symbol id="e" overflow="visible">
                                                <path
                                                    d="m9.5938-7.1719c-1.0625 0-1.8672 0.18359-2.4062 0.54688-0.53125 0.35547-0.79688 0.88281-0.79688 1.5781 0 0.64844 0.21094 1.1523 0.64062 1.5156 0.4375 0.36719 1.0391 0.54688 1.8125 0.54688 0.95703 0 1.7656-0.34375 2.4219-1.0312s0.98438-1.5469 0.98438-2.5781v-0.57812zm7.7969-1.9375v9.1094h-5.1406v-2.3594c-0.6875 0.96875-1.4609 1.6719-2.3125 2.1094-0.85547 0.4375-1.8906 0.65625-3.1094 0.65625-1.6562 0-3-0.47656-4.0312-1.4375-1.0312-0.96875-1.5469-2.2188-1.5469-3.75 0-1.875 0.64062-3.25 1.9219-4.125 1.2891-0.875 3.3164-1.3125 6.0781-1.3125h3v-0.39062c0-0.8125-0.32031-1.4062-0.95312-1.7812-0.63672-0.375-1.6328-0.5625-2.9844-0.5625-1.0859 0-2.1016 0.10938-3.0469 0.32812-0.9375 0.21875-1.8086 0.54688-2.6094 0.98438v-3.8906c1.082-0.25781 2.1758-0.45703 3.2812-0.59375 1.1016-0.14453 2.207-0.21875 3.3125-0.21875 2.875 0 4.9453 0.57031 6.2188 1.7031 1.2812 1.1367 1.9219 2.9805 1.9219 5.5312z" />
                                            </symbol>
                                            <symbol id="d" overflow="visible">
                                                <path
                                                    d="m8.0156-20.484v4.5312h5.2656v3.6406h-5.2656v6.7656c0 0.74219 0.14453 1.2461 0.4375 1.5156 0.30078 0.26172 0.89062 0.39062 1.7656 0.39062h2.6094v3.6406h-4.3594c-2.0234 0-3.4531-0.41406-4.2969-1.25-0.83594-0.84375-1.25-2.2734-1.25-4.2969v-6.7656h-2.5312v-3.6406h2.5312v-4.5312z" />
                                            </symbol>
                                            <symbol id="h" overflow="visible">
                                                <path
                                                    d="m13.297-13.625v-8.5312h5.1406v22.156h-5.1406v-2.3125c-0.69922 0.94922-1.4688 1.6406-2.3125 2.0781-0.84375 0.42578-1.8242 0.64062-2.9375 0.64062-1.9688 0-3.5859-0.77344-4.8438-2.3281-1.2617-1.5625-1.8906-3.5781-1.8906-6.0469 0-2.457 0.62891-4.4688 1.8906-6.0312 1.2578-1.5625 2.875-2.3438 4.8438-2.3438 1.1016 0 2.0781 0.22656 2.9219 0.67188 0.85156 0.4375 1.6289 1.1211 2.3281 2.0469zm-3.3594 10.328c1.0938 0 1.9258-0.39453 2.5-1.1875 0.57031-0.80078 0.85938-1.9609 0.85938-3.4844 0-1.5078-0.28906-2.6641-0.85938-3.4688-0.57422-0.80078-1.4062-1.2031-2.5-1.2031-1.0859 0-1.9141 0.40234-2.4844 1.2031-0.57422 0.80469-0.85938 1.9609-0.85938 3.4688 0 1.5234 0.28516 2.6836 0.85938 3.4844 0.57031 0.79297 1.3984 1.1875 2.4844 1.1875z" />
                                            </symbol>
                                            <symbol id="g" overflow="visible">
                                                <path
                                                    d="m10.938-3.2969c1.0938 0 1.9258-0.39453 2.5-1.1875 0.57031-0.80078 0.85938-1.9609 0.85938-3.4844 0-1.5078-0.28906-2.6641-0.85938-3.4688-0.57422-0.80078-1.4062-1.2031-2.5-1.2031s-1.9336 0.40234-2.5156 1.2031c-0.58594 0.80469-0.875 1.9609-0.875 3.4688 0 1.5117 0.28906 2.668 0.875 3.4688 0.58203 0.80469 1.4219 1.2031 2.5156 1.2031zm-3.3906-10.328c0.70703-0.92578 1.4883-1.6094 2.3438-2.0469 0.85156-0.44531 1.832-0.67188 2.9375-0.67188 1.9688 0 3.582 0.78125 4.8438 2.3438 1.2695 1.5625 1.9062 3.5742 1.9062 6.0312 0 2.4688-0.63672 4.4844-1.9062 6.0469-1.2617 1.5547-2.875 2.3281-4.8438 2.3281-1.1055 0-2.0859-0.21875-2.9375-0.65625-0.85547-0.4375-1.6367-1.125-2.3438-2.0625v2.3125h-5.0938v-22.156h5.0938z" />
                                            </symbol>
                                            <symbol id="l" overflow="visible">
                                                <path
                                                    d="m0.35938-15.953h5.0938l4.2969 10.828 3.6406-10.828h5.0938l-6.7031 17.469c-0.67969 1.7695-1.4648 3.0078-2.3594 3.7188-0.89844 0.70703-2.0781 1.0625-3.5469 1.0625h-2.9531v-3.3438h1.5938c0.86328 0 1.4922-0.14062 1.8906-0.42188 0.39453-0.27344 0.70312-0.76562 0.92188-1.4844l0.14062-0.4375z" />
                                            </symbol>
                                            <symbol id="f" overflow="visible">
                                                <path
                                                    d="m2.2812-6.2031v-9.75h5.125v1.5938c0 0.86719-0.007812 1.9531-0.015625 3.2656-0.011719 1.3047-0.015625 2.1719-0.015625 2.6094 0 1.2812 0.03125 2.2031 0.09375 2.7656 0.070312 0.5625 0.1875 0.97656 0.34375 1.2344 0.21875 0.33594 0.49219 0.58984 0.82812 0.76562 0.33203 0.17969 0.71875 0.26562 1.1562 0.26562 1.0625 0 1.8945-0.40625 2.5-1.2188 0.61328-0.8125 0.92188-1.9453 0.92188-3.4062v-7.875h5.0938v15.953h-5.0938v-2.3125c-0.77344 0.9375-1.5898 1.625-2.4531 2.0625-0.85547 0.4375-1.7969 0.65625-2.8281 0.65625-1.8438 0-3.25-0.5625-4.2188-1.6875-0.96094-1.1328-1.4375-2.7734-1.4375-4.9219z" />
                                            </symbol>
                                            <symbol id="r" overflow="visible">
                                                <path d="m2.4531-22.156h5.0938v22.156h-5.0938z" />
                                            </symbol>
                                            <symbol id="c" overflow="visible">
                                                <path
                                                    d="m10.047-12.688c-1.1367 0-2 0.40625-2.5938 1.2188s-0.89062 1.9805-0.89062 3.5c0 1.5312 0.29688 2.7031 0.89062 3.5156s1.457 1.2188 2.5938 1.2188c1.1016 0 1.9453-0.40625 2.5312-1.2188 0.59375-0.8125 0.89062-1.9844 0.89062-3.5156 0-1.5195-0.29688-2.6875-0.89062-3.5-0.58594-0.8125-1.4297-1.2188-2.5312-1.2188zm0-3.6562c2.7383 0 4.8789 0.74609 6.4219 2.2344 1.5391 1.4805 2.3125 3.5273 2.3125 6.1406 0 2.625-0.77344 4.6797-2.3125 6.1562-1.543 1.4805-3.6836 2.2188-6.4219 2.2188-2.7617 0-4.918-0.73828-6.4688-2.2188-1.5547-1.4766-2.3281-3.5312-2.3281-6.1562 0-2.6133 0.77344-4.6602 2.3281-6.1406 1.5508-1.4883 3.707-2.2344 6.4688-2.2344z" />
                                            </symbol>
                                            <symbol id="k" overflow="visible">
                                                <path
                                                    d="m18.484-9.7188v9.7188h-5.125v-7.4062c0-1.3945-0.03125-2.3516-0.09375-2.875-0.0625-0.51953-0.16797-0.90625-0.3125-1.1562-0.19922-0.33203-0.46875-0.58594-0.8125-0.76562-0.34375-0.1875-0.73438-0.28125-1.1719-0.28125-1.0625 0-1.9023 0.41406-2.5156 1.2344-0.60547 0.8125-0.90625 1.9492-0.90625 3.4062v7.8438h-5.0938v-22.156h5.0938v8.5312c0.76953-0.92578 1.5859-1.6094 2.4531-2.0469 0.86328-0.44531 1.8164-0.67188 2.8594-0.67188 1.8438 0 3.2383 0.57031 4.1875 1.7031 0.95703 1.125 1.4375 2.7656 1.4375 4.9219z" />
                                            </symbol>
                                            <symbol id="j" overflow="visible">
                                                <path
                                                    d="m17.234-13.297c0.64453-0.98828 1.4102-1.7422 2.2969-2.2656 0.89453-0.51953 1.875-0.78125 2.9375-0.78125 1.832 0 3.2266 0.57031 4.1875 1.7031 0.95703 1.125 1.4375 2.7656 1.4375 4.9219v9.7188h-5.125v-8.3125-0.39062c0.007812-0.13281 0.015625-0.32031 0.015625-0.5625 0-1.1328-0.16797-1.9531-0.5-2.4531-0.32422-0.50781-0.85938-0.76562-1.6094-0.76562-0.96875 0-1.7188 0.40234-2.25 1.2031-0.52344 0.79297-0.79297 1.9453-0.8125 3.4531v7.8281h-5.125v-8.3125c0-1.7695-0.15234-2.9062-0.45312-3.4062-0.30469-0.50781-0.84375-0.76562-1.625-0.76562-0.98047 0-1.7344 0.40234-2.2656 1.2031-0.53125 0.80469-0.79688 1.9492-0.79688 3.4375v7.8438h-5.125v-15.953h5.125v2.3281c0.625-0.89453 1.3438-1.5703 2.1562-2.0312 0.8125-0.45703 1.707-0.6875 2.6875-0.6875 1.1016 0 2.0781 0.26562 2.9219 0.79688s1.4844 1.2812 1.9219 2.25z" />
                                            </symbol>
                                            <symbol id="i" overflow="visible">
                                                <path
                                                    d="m18.484-9.7188v9.7188h-5.125v-7.4375c0-1.375-0.03125-2.3203-0.09375-2.8438-0.0625-0.51953-0.16797-0.90625-0.3125-1.1562-0.19922-0.33203-0.46875-0.58594-0.8125-0.76562-0.34375-0.1875-0.73438-0.28125-1.1719-0.28125-1.0625 0-1.9023 0.41406-2.5156 1.2344-0.60547 0.8125-0.90625 1.9492-0.90625 3.4062v7.8438h-5.0938v-15.953h5.0938v2.3281c0.76953-0.92578 1.5859-1.6094 2.4531-2.0469 0.86328-0.44531 1.8164-0.67188 2.8594-0.67188 1.8438 0 3.2383 0.57031 4.1875 1.7031 0.95703 1.125 1.4375 2.7656 1.4375 4.9219z" />
                                            </symbol>
                                            <symbol id="q" overflow="visible">
                                                <path
                                                    d="m12.953-22.156v3.3438h-2.8281c-0.71875 0-1.2266 0.13281-1.5156 0.39062-0.28125 0.26172-0.42188 0.71484-0.42188 1.3594v1.1094h4.3594v3.6406h-4.3594v12.312h-5.0938v-12.312h-2.5312v-3.6406h2.5312v-1.1094c0-1.7383 0.48438-3.0195 1.4531-3.8438 0.96875-0.83203 2.4688-1.25 4.5-1.25z" />
                                            </symbol>
                                            <symbol id="p" overflow="visible">
                                                <path
                                                    d="m2.6719-21.266h6.125l7.7344 14.578v-14.578h5.2031v21.266h-6.125l-7.7344-14.594v14.594h-5.2031z" />
                                            </symbol>
                                            <symbol id="o" overflow="visible">
                                                <path
                                                    d="m2.6719-21.266h9.1094c2.707 0 4.7852 0.60547 6.2344 1.8125 1.4453 1.1992 2.1719 2.9062 2.1719 5.125 0 2.2305-0.72656 3.9492-2.1719 5.1562-1.4492 1.1992-3.5273 1.7969-6.2344 1.7969h-3.625v7.375h-5.4844zm5.4844 3.9688v5.9375h3.0469c1.0625 0 1.8789-0.25391 2.4531-0.76562 0.58203-0.51953 0.875-1.2539 0.875-2.2031 0-0.94531-0.29297-1.6758-0.875-2.1875-0.57422-0.51953-1.3906-0.78125-2.4531-0.78125z" />
                                            </symbol>
                                            <symbol id="n" overflow="visible">
                                                <path
                                                    d="m2.4531-15.953h5.0938v15.672c0 2.1328-0.51562 3.7656-1.5469 4.8906-1.0234 1.125-2.5078 1.6875-4.4531 1.6875h-2.5156v-3.3438h0.89062c0.96875 0 1.6289-0.21875 1.9844-0.65625 0.36328-0.4375 0.54688-1.2969 0.54688-2.5781zm0-6.2031h5.0938v4.1562h-5.0938z" />
                                            </symbol>
                                            <symbol id="m" overflow="visible">
                                                <path
                                                    d="m15.344-15.453v4.1562c-0.69922-0.46875-1.3984-0.81641-2.0938-1.0469-0.69922-0.22656-1.4219-0.34375-2.1719-0.34375-1.4297 0-2.5391 0.41797-3.3281 1.25-0.79297 0.82422-1.1875 1.9805-1.1875 3.4688 0 1.5 0.39453 2.668 1.1875 3.5 0.78906 0.82422 1.8984 1.2344 3.3281 1.2344 0.80078 0 1.5547-0.11719 2.2656-0.35938 0.71875-0.23828 1.3828-0.58594 2-1.0469v4.1719c-0.80469 0.29297-1.6172 0.50781-2.4375 0.65625-0.8125 0.14453-1.6367 0.21875-2.4688 0.21875-2.875 0-5.125-0.73438-6.75-2.2031-1.625-1.4766-2.4375-3.5352-2.4375-6.1719 0-2.625 0.8125-4.6758 2.4375-6.1562 1.625-1.4766 3.875-2.2188 6.75-2.2188 0.83203 0 1.6562 0.078125 2.4688 0.23438 0.8125 0.14844 1.625 0.36719 2.4375 0.65625z" />
                                            </symbol>
                                        </defs>
                                        <g>
                                            <path
                                                d="m350.68 273.18c0 3.625-2.9297 6.5742-6.5625 6.5742-3.6172 0-6.5547-2.9062-6.5547-6.5742 0-3.6172 2.9414-6.5625 6.5547-6.5625 3.6328 0 6.5625 2.9414 6.5625 6.5625zm-46.438-139.73c10.117-11.414 24.656-17.957 39.875-17.957 29.391 0 53.297 23.906 53.297 53.289 0 22.727-14.418 42.977-35.891 50.387-6.6914 2.3008-10.844 8.1328-10.844 15.207v12.07c0 3.6328-2.9297 6.5625-6.5625 6.5625-3.6133 0-6.5547-2.9297-6.5547-6.5625v-12.07c0-12.648 7.7188-23.477 19.68-27.598 16.184-5.5977 27.055-20.863 27.055-37.992 0-22.148-18.016-40.172-40.18-40.172-11.477 0-22.43 4.9414-30.051 13.531-2.4141 2.7227-6.5547 2.9648-9.2656 0.56641-2.7148-2.4141-2.957-6.5508-0.55859-9.2617zm-32.078-75.066c-1.8047-3.1367-0.73828-7.1484 2.3984-8.9531 3.1445-1.8281 7.1562-0.74609 8.9609 2.3984l15.148 26.227c2.5469 4.4062-0.70703 9.8359-5.6797 9.8359-2.2656 0-4.4648-1.1719-5.6875-3.2812zm-52.82 46.262c1.8047-3.1445 5.8164-4.2109 8.9609-2.3984l26.227 15.145c5.8086 3.3477 3.3789 12.234-3.2812 12.234-1.1172 0-2.2383-0.28125-3.2812-0.88281l-26.227-15.145c-3.1367-1.8047-4.2031-5.8164-2.3984-8.9531zm-20.211 75.438c0-3.6172 2.9297-6.5625 6.5547-6.5625h30.289c3.625 0 6.5625 2.9453 6.5625 6.5625 0 3.6172-2.9375 6.5547-6.5625 6.5547h-30.289c-3.625 0-6.5547-2.9375-6.5547-6.5547zm264.89-6.5625h30.301c3.6133 0 6.5547 2.9453 6.5547 6.5625 0 3.6172-2.9414 6.5547-6.5547 6.5547h-30.301c-3.6133 0-6.5547-2.9375-6.5547-6.5547 0-3.6211 2.9453-6.5625 6.5547-6.5625zm-20.945-47.176c-1.8203-3.1367-0.74219-7.1484 2.3984-8.9531l26.227-15.145c3.1367-1.8125 7.1484-0.74609 8.9531 2.3984 1.8203 3.1367 0.74609 7.1484-2.3984 8.9531l-26.227 15.145c-3.1016 1.8008-7.1445 0.76562-8.9531-2.3984zm-41.738-48.289 15.145-26.227c1.8047-3.1445 5.8164-4.2266 8.9531-2.3984 3.1445 1.8047 4.2188 5.8164 2.3984 8.9531l-15.145 26.227c-1.8281 3.168-5.8438 4.1992-8.9531 2.3984-3.1406-1.8047-4.2188-5.8164-2.3984-8.9531zm9.625 305.35-48.656-72.402h145.94l49.773 72.402zm94.168 110.79v-97.664h-97.664c-2.1836 0-4.2305-1.0977-5.4453-2.9102l-45.457-67.652v172.36h144.44c2.2422 0.003907 4.1289-1.8906 4.1289-4.1328zm-306.13 4.1367c-2.2383 0-4.1367-1.8945-4.1367-4.1367v-97.664h97.676c2.1836 0 4.2188-1.0977 5.4453-2.9102l45.457-67.652v172.36zm-7.2461-187.32-49.781 72.402h147.06l48.656-72.402zm384.14 75.246-58.801-85.527c-1.2266-1.7852-3.2383-2.8398-5.4023-2.8398l-323.39 0.003906c-2.1523 0-4.1758 1.0547-5.4023 2.8398l-58.789 85.523c-2.9844 4.3242 0.14062 10.277 5.3984 10.277h52.242v97.664c0 9.5117 7.7422 17.254 17.254 17.254h302c9.5117 0 17.246-7.7422 17.246-17.254l-0.003906-97.664h52.246c5.2461 0 8.3828-5.957 5.4062-10.277z"
                                                fill-rule="evenodd" />
                                        </g>
                                    </svg>
                                    <div>
                                        <span style="color:#000; font-weight: bold;">
                                            There are no entries or data yet
                                        </span>

                                    </div>
                                </div>
                            </div>


                        </div>
                        <div v-else>
                            <!-- entry  -->
                            <div v-if="node.node_type == 3 || node.node_type == 4" style="padding-left: 15px; padding-bottom: 15px; padding-right: 15px;">
                               <div class="normal-txt" v-if="node.node_type == 3" v-html="node.description"></div>
                                <div v-if="node.nodes.length > 0">
                                    <h4
                                        style="color: rgb(13, 13, 13);  font-weight: 700; padding-top:5px; padding-bottom:5px; margin:0px;">
                                        Files/Folders
                                    </h4>
                                    <table style="margin:0px;" class="uk-table uk-table-divider">
                                        <tbody>
                                            <tr v-for="(ch) in node.nodes" :key="ch.node_hash">
                                                <td style="width: 34px; vertical-align: middle">
                                                    <div v-if="ch.node_type <= 2"
                                                        style=" background-color: #000; margin: 0px auto;width: 32px;font-weight: 600;color: white;font-size: 1.2em;text-align: center;border-radius: 4px;height: 32px; ">
                                                        <span style="display:inline-block; margin-top:2px;"> {{
                                                            $filters.firstletter(ch.name) }} </span>
                                                    </div>
                                                    <div v-if="ch.node_type == 3"
                                                        style=" background-color: #3e15ca; margin: 0px auto;width: 32px;font-weight: 600;color: white;font-size: 1.2em;text-align: center;border-radius: 4px;height: 32px; ">
                                                        <span style="display:inline-block; margin-top:2px;"> {{
                                                            $filters.firstletter(ch.name) }} </span>
                                                    </div>
                                                    <img v-if="ch.node_type==4" src="/assets/folder.png" />
                                                    <img v-if="ch.node_type==5" :src="nodeVector(ch.name)" />
                                                </td>
                                                <td>
                                                    <div style="text-align: left; vertical-align: middle; padding-top:5px;">
                                                        <router-link style="font-weight: bold"
                                                            :to="'/channels/node/' + ch.node_hash"> {{ ch.name }}</router-link>
                                                        <div v-if="ch.description != '' && ch.node_type <= 2 " style="font-size: 0.9em; padding: 0; margin: 0">
                                                            {{ ch.description }}
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align: middle; text-align:right;">
                                                    <div>{{ $filters.timestamptodate(ch.timestamp) }}</div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                               </div>

                               <div style="margin-top:15px;" v-if="node.nodes.length == 0 && node.node_type == 4 ">
                                    <div style="text-align: center;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="80pt" height="80pt" version="1.1" viewBox="0 0 700 700"><defs><symbol id="s" overflow="visible"><path d="m19.547-1.1719c-1.0117 0.52344-2.0625 0.91406-3.1562 1.1719-1.0938 0.26953-2.2344 0.40625-3.4219 0.40625-3.543 0-6.3516-0.98828-8.4219-2.9688-2.0625-1.9766-3.0938-4.6602-3.0938-8.0469 0-3.4062 1.0312-6.0977 3.0938-8.0781 2.0703-1.9766 4.8789-2.9688 8.4219-2.9688 1.1875 0 2.3281 0.13672 3.4219 0.40625 1.0938 0.26172 2.1445 0.65625 3.1562 1.1875v4.3906c-1.0234-0.6875-2.0273-1.1914-3.0156-1.5156-0.98047-0.32031-2.0156-0.48438-3.1094-0.48438-1.9609 0-3.5 0.625-4.625 1.875-1.1172 1.25-1.6719 2.9805-1.6719 5.1875 0 2.1875 0.55469 3.9141 1.6719 5.1719 1.125 1.25 2.6641 1.875 4.625 1.875 1.0938 0 2.1289-0.16016 3.1094-0.48438 0.98828-0.32031 1.9922-0.82812 3.0156-1.5156z"></path></symbol><symbol id="b" overflow="visible"><path d="m14.297-11.609c-0.44922-0.20703-0.89062-0.35938-1.3281-0.45312-0.4375-0.10156-0.88281-0.15625-1.3281-0.15625-1.3125 0-2.3242 0.42188-3.0312 1.2656-0.71094 0.83594-1.0625 2.0391-1.0625 3.6094v7.3438h-5.0938v-15.953h5.0938v2.625c0.65625-1.0508 1.4062-1.8164 2.25-2.2969 0.85156-0.47656 1.875-0.71875 3.0625-0.71875 0.17578 0 0.36328 0.011719 0.5625 0.03125 0.19531 0.011719 0.48438 0.042969 0.85938 0.09375z"></path></symbol><symbol id="a" overflow="visible"><path d="m18.375-8.0156v1.4531h-11.922c0.125 1.1992 0.55469 2.0938 1.2969 2.6875 0.73828 0.59375 1.7734 0.89062 3.1094 0.89062 1.0703 0 2.1719-0.15625 3.2969-0.46875 1.125-0.32031 2.2812-0.80469 3.4688-1.4531v3.9375c-1.2109 0.46094-2.418 0.80469-3.625 1.0312-1.2109 0.22656-2.4141 0.34375-3.6094 0.34375-2.8984 0-5.1484-0.72656-6.75-2.1875-1.5938-1.4688-2.3906-3.5312-2.3906-6.1875 0-2.5938 0.78516-4.6328 2.3594-6.125 1.5703-1.5 3.7344-2.25 6.4844-2.25 2.5078 0 4.5156 0.75781 6.0156 2.2656 1.5078 1.5117 2.2656 3.5312 2.2656 6.0625zm-5.2344-1.7031c0-0.96875-0.28906-1.75-0.85938-2.3438-0.5625-0.59375-1.2969-0.89062-2.2031-0.89062-0.99219 0-1.7969 0.28125-2.4219 0.84375-0.61719 0.55469-0.99609 1.3516-1.1406 2.3906z"></path></symbol><symbol id="e" overflow="visible"><path d="m9.5938-7.1719c-1.0625 0-1.8672 0.18359-2.4062 0.54688-0.53125 0.35547-0.79688 0.88281-0.79688 1.5781 0 0.64844 0.21094 1.1523 0.64062 1.5156 0.4375 0.36719 1.0391 0.54688 1.8125 0.54688 0.95703 0 1.7656-0.34375 2.4219-1.0312s0.98438-1.5469 0.98438-2.5781v-0.57812zm7.7969-1.9375v9.1094h-5.1406v-2.3594c-0.6875 0.96875-1.4609 1.6719-2.3125 2.1094-0.85547 0.4375-1.8906 0.65625-3.1094 0.65625-1.6562 0-3-0.47656-4.0312-1.4375-1.0312-0.96875-1.5469-2.2188-1.5469-3.75 0-1.875 0.64062-3.25 1.9219-4.125 1.2891-0.875 3.3164-1.3125 6.0781-1.3125h3v-0.39062c0-0.8125-0.32031-1.4062-0.95312-1.7812-0.63672-0.375-1.6328-0.5625-2.9844-0.5625-1.0859 0-2.1016 0.10938-3.0469 0.32812-0.9375 0.21875-1.8086 0.54688-2.6094 0.98438v-3.8906c1.082-0.25781 2.1758-0.45703 3.2812-0.59375 1.1016-0.14453 2.207-0.21875 3.3125-0.21875 2.875 0 4.9453 0.57031 6.2188 1.7031 1.2812 1.1367 1.9219 2.9805 1.9219 5.5312z"></path></symbol><symbol id="d" overflow="visible"><path d="m8.0156-20.484v4.5312h5.2656v3.6406h-5.2656v6.7656c0 0.74219 0.14453 1.2461 0.4375 1.5156 0.30078 0.26172 0.89062 0.39062 1.7656 0.39062h2.6094v3.6406h-4.3594c-2.0234 0-3.4531-0.41406-4.2969-1.25-0.83594-0.84375-1.25-2.2734-1.25-4.2969v-6.7656h-2.5312v-3.6406h2.5312v-4.5312z"></path></symbol><symbol id="h" overflow="visible"><path d="m13.297-13.625v-8.5312h5.1406v22.156h-5.1406v-2.3125c-0.69922 0.94922-1.4688 1.6406-2.3125 2.0781-0.84375 0.42578-1.8242 0.64062-2.9375 0.64062-1.9688 0-3.5859-0.77344-4.8438-2.3281-1.2617-1.5625-1.8906-3.5781-1.8906-6.0469 0-2.457 0.62891-4.4688 1.8906-6.0312 1.2578-1.5625 2.875-2.3438 4.8438-2.3438 1.1016 0 2.0781 0.22656 2.9219 0.67188 0.85156 0.4375 1.6289 1.1211 2.3281 2.0469zm-3.3594 10.328c1.0938 0 1.9258-0.39453 2.5-1.1875 0.57031-0.80078 0.85938-1.9609 0.85938-3.4844 0-1.5078-0.28906-2.6641-0.85938-3.4688-0.57422-0.80078-1.4062-1.2031-2.5-1.2031-1.0859 0-1.9141 0.40234-2.4844 1.2031-0.57422 0.80469-0.85938 1.9609-0.85938 3.4688 0 1.5234 0.28516 2.6836 0.85938 3.4844 0.57031 0.79297 1.3984 1.1875 2.4844 1.1875z"></path></symbol><symbol id="g" overflow="visible"><path d="m10.938-3.2969c1.0938 0 1.9258-0.39453 2.5-1.1875 0.57031-0.80078 0.85938-1.9609 0.85938-3.4844 0-1.5078-0.28906-2.6641-0.85938-3.4688-0.57422-0.80078-1.4062-1.2031-2.5-1.2031s-1.9336 0.40234-2.5156 1.2031c-0.58594 0.80469-0.875 1.9609-0.875 3.4688 0 1.5117 0.28906 2.668 0.875 3.4688 0.58203 0.80469 1.4219 1.2031 2.5156 1.2031zm-3.3906-10.328c0.70703-0.92578 1.4883-1.6094 2.3438-2.0469 0.85156-0.44531 1.832-0.67188 2.9375-0.67188 1.9688 0 3.582 0.78125 4.8438 2.3438 1.2695 1.5625 1.9062 3.5742 1.9062 6.0312 0 2.4688-0.63672 4.4844-1.9062 6.0469-1.2617 1.5547-2.875 2.3281-4.8438 2.3281-1.1055 0-2.0859-0.21875-2.9375-0.65625-0.85547-0.4375-1.6367-1.125-2.3438-2.0625v2.3125h-5.0938v-22.156h5.0938z"></path></symbol><symbol id="l" overflow="visible"><path d="m0.35938-15.953h5.0938l4.2969 10.828 3.6406-10.828h5.0938l-6.7031 17.469c-0.67969 1.7695-1.4648 3.0078-2.3594 3.7188-0.89844 0.70703-2.0781 1.0625-3.5469 1.0625h-2.9531v-3.3438h1.5938c0.86328 0 1.4922-0.14062 1.8906-0.42188 0.39453-0.27344 0.70312-0.76562 0.92188-1.4844l0.14062-0.4375z"></path></symbol><symbol id="f" overflow="visible"><path d="m2.2812-6.2031v-9.75h5.125v1.5938c0 0.86719-0.007812 1.9531-0.015625 3.2656-0.011719 1.3047-0.015625 2.1719-0.015625 2.6094 0 1.2812 0.03125 2.2031 0.09375 2.7656 0.070312 0.5625 0.1875 0.97656 0.34375 1.2344 0.21875 0.33594 0.49219 0.58984 0.82812 0.76562 0.33203 0.17969 0.71875 0.26562 1.1562 0.26562 1.0625 0 1.8945-0.40625 2.5-1.2188 0.61328-0.8125 0.92188-1.9453 0.92188-3.4062v-7.875h5.0938v15.953h-5.0938v-2.3125c-0.77344 0.9375-1.5898 1.625-2.4531 2.0625-0.85547 0.4375-1.7969 0.65625-2.8281 0.65625-1.8438 0-3.25-0.5625-4.2188-1.6875-0.96094-1.1328-1.4375-2.7734-1.4375-4.9219z"></path></symbol><symbol id="r" overflow="visible"><path d="m2.4531-22.156h5.0938v22.156h-5.0938z"></path></symbol><symbol id="c" overflow="visible"><path d="m10.047-12.688c-1.1367 0-2 0.40625-2.5938 1.2188s-0.89062 1.9805-0.89062 3.5c0 1.5312 0.29688 2.7031 0.89062 3.5156s1.457 1.2188 2.5938 1.2188c1.1016 0 1.9453-0.40625 2.5312-1.2188 0.59375-0.8125 0.89062-1.9844 0.89062-3.5156 0-1.5195-0.29688-2.6875-0.89062-3.5-0.58594-0.8125-1.4297-1.2188-2.5312-1.2188zm0-3.6562c2.7383 0 4.8789 0.74609 6.4219 2.2344 1.5391 1.4805 2.3125 3.5273 2.3125 6.1406 0 2.625-0.77344 4.6797-2.3125 6.1562-1.543 1.4805-3.6836 2.2188-6.4219 2.2188-2.7617 0-4.918-0.73828-6.4688-2.2188-1.5547-1.4766-2.3281-3.5312-2.3281-6.1562 0-2.6133 0.77344-4.6602 2.3281-6.1406 1.5508-1.4883 3.707-2.2344 6.4688-2.2344z"></path></symbol><symbol id="k" overflow="visible"><path d="m18.484-9.7188v9.7188h-5.125v-7.4062c0-1.3945-0.03125-2.3516-0.09375-2.875-0.0625-0.51953-0.16797-0.90625-0.3125-1.1562-0.19922-0.33203-0.46875-0.58594-0.8125-0.76562-0.34375-0.1875-0.73438-0.28125-1.1719-0.28125-1.0625 0-1.9023 0.41406-2.5156 1.2344-0.60547 0.8125-0.90625 1.9492-0.90625 3.4062v7.8438h-5.0938v-22.156h5.0938v8.5312c0.76953-0.92578 1.5859-1.6094 2.4531-2.0469 0.86328-0.44531 1.8164-0.67188 2.8594-0.67188 1.8438 0 3.2383 0.57031 4.1875 1.7031 0.95703 1.125 1.4375 2.7656 1.4375 4.9219z"></path></symbol><symbol id="j" overflow="visible"><path d="m17.234-13.297c0.64453-0.98828 1.4102-1.7422 2.2969-2.2656 0.89453-0.51953 1.875-0.78125 2.9375-0.78125 1.832 0 3.2266 0.57031 4.1875 1.7031 0.95703 1.125 1.4375 2.7656 1.4375 4.9219v9.7188h-5.125v-8.3125-0.39062c0.007812-0.13281 0.015625-0.32031 0.015625-0.5625 0-1.1328-0.16797-1.9531-0.5-2.4531-0.32422-0.50781-0.85938-0.76562-1.6094-0.76562-0.96875 0-1.7188 0.40234-2.25 1.2031-0.52344 0.79297-0.79297 1.9453-0.8125 3.4531v7.8281h-5.125v-8.3125c0-1.7695-0.15234-2.9062-0.45312-3.4062-0.30469-0.50781-0.84375-0.76562-1.625-0.76562-0.98047 0-1.7344 0.40234-2.2656 1.2031-0.53125 0.80469-0.79688 1.9492-0.79688 3.4375v7.8438h-5.125v-15.953h5.125v2.3281c0.625-0.89453 1.3438-1.5703 2.1562-2.0312 0.8125-0.45703 1.707-0.6875 2.6875-0.6875 1.1016 0 2.0781 0.26562 2.9219 0.79688s1.4844 1.2812 1.9219 2.25z"></path></symbol><symbol id="i" overflow="visible"><path d="m18.484-9.7188v9.7188h-5.125v-7.4375c0-1.375-0.03125-2.3203-0.09375-2.8438-0.0625-0.51953-0.16797-0.90625-0.3125-1.1562-0.19922-0.33203-0.46875-0.58594-0.8125-0.76562-0.34375-0.1875-0.73438-0.28125-1.1719-0.28125-1.0625 0-1.9023 0.41406-2.5156 1.2344-0.60547 0.8125-0.90625 1.9492-0.90625 3.4062v7.8438h-5.0938v-15.953h5.0938v2.3281c0.76953-0.92578 1.5859-1.6094 2.4531-2.0469 0.86328-0.44531 1.8164-0.67188 2.8594-0.67188 1.8438 0 3.2383 0.57031 4.1875 1.7031 0.95703 1.125 1.4375 2.7656 1.4375 4.9219z"></path></symbol><symbol id="q" overflow="visible"><path d="m12.953-22.156v3.3438h-2.8281c-0.71875 0-1.2266 0.13281-1.5156 0.39062-0.28125 0.26172-0.42188 0.71484-0.42188 1.3594v1.1094h4.3594v3.6406h-4.3594v12.312h-5.0938v-12.312h-2.5312v-3.6406h2.5312v-1.1094c0-1.7383 0.48438-3.0195 1.4531-3.8438 0.96875-0.83203 2.4688-1.25 4.5-1.25z"></path></symbol><symbol id="p" overflow="visible"><path d="m2.6719-21.266h6.125l7.7344 14.578v-14.578h5.2031v21.266h-6.125l-7.7344-14.594v14.594h-5.2031z"></path></symbol><symbol id="o" overflow="visible"><path d="m2.6719-21.266h9.1094c2.707 0 4.7852 0.60547 6.2344 1.8125 1.4453 1.1992 2.1719 2.9062 2.1719 5.125 0 2.2305-0.72656 3.9492-2.1719 5.1562-1.4492 1.1992-3.5273 1.7969-6.2344 1.7969h-3.625v7.375h-5.4844zm5.4844 3.9688v5.9375h3.0469c1.0625 0 1.8789-0.25391 2.4531-0.76562 0.58203-0.51953 0.875-1.2539 0.875-2.2031 0-0.94531-0.29297-1.6758-0.875-2.1875-0.57422-0.51953-1.3906-0.78125-2.4531-0.78125z"></path></symbol><symbol id="n" overflow="visible"><path d="m2.4531-15.953h5.0938v15.672c0 2.1328-0.51562 3.7656-1.5469 4.8906-1.0234 1.125-2.5078 1.6875-4.4531 1.6875h-2.5156v-3.3438h0.89062c0.96875 0 1.6289-0.21875 1.9844-0.65625 0.36328-0.4375 0.54688-1.2969 0.54688-2.5781zm0-6.2031h5.0938v4.1562h-5.0938z"></path></symbol><symbol id="m" overflow="visible"><path d="m15.344-15.453v4.1562c-0.69922-0.46875-1.3984-0.81641-2.0938-1.0469-0.69922-0.22656-1.4219-0.34375-2.1719-0.34375-1.4297 0-2.5391 0.41797-3.3281 1.25-0.79297 0.82422-1.1875 1.9805-1.1875 3.4688 0 1.5 0.39453 2.668 1.1875 3.5 0.78906 0.82422 1.8984 1.2344 3.3281 1.2344 0.80078 0 1.5547-0.11719 2.2656-0.35938 0.71875-0.23828 1.3828-0.58594 2-1.0469v4.1719c-0.80469 0.29297-1.6172 0.50781-2.4375 0.65625-0.8125 0.14453-1.6367 0.21875-2.4688 0.21875-2.875 0-5.125-0.73438-6.75-2.2031-1.625-1.4766-2.4375-3.5352-2.4375-6.1719 0-2.625 0.8125-4.6758 2.4375-6.1562 1.625-1.4766 3.875-2.2188 6.75-2.2188 0.83203 0 1.6562 0.078125 2.4688 0.23438 0.8125 0.14844 1.625 0.36719 2.4375 0.65625z"></path></symbol></defs><g><path d="m350.68 273.18c0 3.625-2.9297 6.5742-6.5625 6.5742-3.6172 0-6.5547-2.9062-6.5547-6.5742 0-3.6172 2.9414-6.5625 6.5547-6.5625 3.6328 0 6.5625 2.9414 6.5625 6.5625zm-46.438-139.73c10.117-11.414 24.656-17.957 39.875-17.957 29.391 0 53.297 23.906 53.297 53.289 0 22.727-14.418 42.977-35.891 50.387-6.6914 2.3008-10.844 8.1328-10.844 15.207v12.07c0 3.6328-2.9297 6.5625-6.5625 6.5625-3.6133 0-6.5547-2.9297-6.5547-6.5625v-12.07c0-12.648 7.7188-23.477 19.68-27.598 16.184-5.5977 27.055-20.863 27.055-37.992 0-22.148-18.016-40.172-40.18-40.172-11.477 0-22.43 4.9414-30.051 13.531-2.4141 2.7227-6.5547 2.9648-9.2656 0.56641-2.7148-2.4141-2.957-6.5508-0.55859-9.2617zm-32.078-75.066c-1.8047-3.1367-0.73828-7.1484 2.3984-8.9531 3.1445-1.8281 7.1562-0.74609 8.9609 2.3984l15.148 26.227c2.5469 4.4062-0.70703 9.8359-5.6797 9.8359-2.2656 0-4.4648-1.1719-5.6875-3.2812zm-52.82 46.262c1.8047-3.1445 5.8164-4.2109 8.9609-2.3984l26.227 15.145c5.8086 3.3477 3.3789 12.234-3.2812 12.234-1.1172 0-2.2383-0.28125-3.2812-0.88281l-26.227-15.145c-3.1367-1.8047-4.2031-5.8164-2.3984-8.9531zm-20.211 75.438c0-3.6172 2.9297-6.5625 6.5547-6.5625h30.289c3.625 0 6.5625 2.9453 6.5625 6.5625 0 3.6172-2.9375 6.5547-6.5625 6.5547h-30.289c-3.625 0-6.5547-2.9375-6.5547-6.5547zm264.89-6.5625h30.301c3.6133 0 6.5547 2.9453 6.5547 6.5625 0 3.6172-2.9414 6.5547-6.5547 6.5547h-30.301c-3.6133 0-6.5547-2.9375-6.5547-6.5547 0-3.6211 2.9453-6.5625 6.5547-6.5625zm-20.945-47.176c-1.8203-3.1367-0.74219-7.1484 2.3984-8.9531l26.227-15.145c3.1367-1.8125 7.1484-0.74609 8.9531 2.3984 1.8203 3.1367 0.74609 7.1484-2.3984 8.9531l-26.227 15.145c-3.1016 1.8008-7.1445 0.76562-8.9531-2.3984zm-41.738-48.289 15.145-26.227c1.8047-3.1445 5.8164-4.2266 8.9531-2.3984 3.1445 1.8047 4.2188 5.8164 2.3984 8.9531l-15.145 26.227c-1.8281 3.168-5.8438 4.1992-8.9531 2.3984-3.1406-1.8047-4.2188-5.8164-2.3984-8.9531zm9.625 305.35-48.656-72.402h145.94l49.773 72.402zm94.168 110.79v-97.664h-97.664c-2.1836 0-4.2305-1.0977-5.4453-2.9102l-45.457-67.652v172.36h144.44c2.2422 0.003907 4.1289-1.8906 4.1289-4.1328zm-306.13 4.1367c-2.2383 0-4.1367-1.8945-4.1367-4.1367v-97.664h97.676c2.1836 0 4.2188-1.0977 5.4453-2.9102l45.457-67.652v172.36zm-7.2461-187.32-49.781 72.402h147.06l48.656-72.402zm384.14 75.246-58.801-85.527c-1.2266-1.7852-3.2383-2.8398-5.4023-2.8398l-323.39 0.003906c-2.1523 0-4.1758 1.0547-5.4023 2.8398l-58.789 85.523c-2.9844 4.3242 0.14062 10.277 5.3984 10.277h52.242v97.664c0 9.5117 7.7422 17.254 17.254 17.254h302c9.5117 0 17.246-7.7422 17.246-17.254l-0.003906-97.664h52.246c5.2461 0 8.3828-5.957 5.4062-10.277z" fill-rule="evenodd"></path></g></svg><div>
                                        <span style="color: rgb(0, 0, 0); font-weight: bold;"> This folder is empty </span></div></div>
                               </div>

                            </div>

                            <!-- file  -->
                            <div v-if="node.node_type == 5" style="padding-left: 15px; padding-bottom: 15px; padding-right: 15px;">
                               <div style="text-align: center;">
                                    <img style="width:64px; height:64px;" v-if="node.node_type==5" :src="nodeVector(node.name)" />
                                    <div style="margin-top:10px; text-align:left;">
                                        <br /> <span class="normal-txt" style="font-weight:500;"> Name: </span><span class="normal-txt"> {{ node.name }} </span>
                                        <br /> <span class="normal-txt" style="font-weight:500;"> File Hash: </span><span class="normal-txt"> {{ node.file_hash }} </span>
                                        <br /> <span class="normal-txt" style="font-weight:500;"> File Merkle Hash: </span><span class="normal-txt"> {{ node.merkle_root }} </span>
                                        <br /> <span class="normal-txt" style="font-weight:500;"> File Node Hash: </span><span class="normal-txt"> {{ node.node_hash }} </span>
                                        <br /> <span class="normal-txt" style="font-weight:500;"> Size: </span><span class="normal-txt"> {{ $filters.formatsize(node.size) }}</span>
                                        <br /> <span class="normal-txt" style="font-weight:500;"> Created At: </span><span class="normal-txt"> {{ $filters.timestamptodate(node.timestamp) }} </span>
                                        
                                        <br /><br />
                                        <router-link style="margin-right: 10px;" :to="'/downloads?hash=' + node.file_hash + '&name=' + node.name">
                                            <button class="uk-button ffg-button" style="width:150px; height:40px; ">
                                                Download
                                                <span class="uk-icon" uk-icon="icon: download"></span>
                                            </button>
                                        </router-link>
                                    </div>
                               </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="modal-newfolder" uk-modal="container:#node-container">
            <div class="uk-modal-dialog uk-modal-body">
                <button id="close-modal-create" class="uk-modal-close-default" type="button" uk-close></button>
                <h2 class="modal-header">Create Folder</h2>
                <div style="padding-bottom:10px; text-align: center; border-bottom:1px solid rgb(230, 230, 230);">
                    <img style="height: 72px; background-color: white; width: 72px; border-radius: 50%;"
                        src="/assets/icon.png" />
                </div>
                <div style="padding: 10px; margin-top:10px;">
                    <div style=" width:100%;" class="uk-inline">
                        <span style="color: #000;" class="uk-form-icon" uk-icon="icon: pencil"></span>
                        <input v-model="folder_name" style="width:100%; border-radius: 4px;" class="uk-input normal-txt"
                            type="text" placeholder="Name" aria-label="Input">
                    </div>
                    <div v-if="validateFolderNameError != ''" style="margin-top:10px;">
                        <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;"
                                uk-icon="icon: warning;"></span> {{ validateFolderNameError }} </span>
                    </div>
                    <br /> <br />
                    <span class="normal-txt" style="font-weight: 500;">
                        Folder creation fees: {{ subchannelRegistrationFees }} FFG
                    </span>
                </div>

                <div style="padding: 10px; margin-top:5px;">
                    <button v-if="!creatingFolder && !folderCreated" @click="createNewFolder"
                        class="uk-button ffg-button"
                        style="font-weight: bold; text-transform: none; width:100%; height:50px;">
                        Create Folder
                        <span class="uk-icon" uk-icon="icon: thumbnails"></span>
                    </button>
                    <div style="text-align:center;" v-if="creatingFolder">
                        <span style="color:#3e15ca;" class="uk-margin-small-right" uk-spinner="ratio: 1"></span>
                    </div>

                    <br />
                    <div v-if="createFolderError != ''" style="margin-top:10px;">
                        <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;"
                                uk-icon="icon: warning;"></span> {{ createFolderError }} </span>
                    </div>
                </div>
            </div>
        </div>

        <div id="modal-createsubchannel" uk-modal="container:#node-container">
            <div class="uk-modal-dialog uk-modal-body">
                <button id="close-modal-create" class="uk-modal-close-default" type="button" uk-close></button>
                <h2 class="modal-header">Create Subchannel</h2>
                <div style="padding-bottom:10px; text-align: center; border-bottom:1px solid rgb(230, 230, 230);">
                    <img style="height: 72px; background-color: white; width: 72px; border-radius: 50%;"
                        src="/assets/icon.png" />
          
                </div>
                <div style="padding: 10px; margin-top:10px;">
                    <div style=" width:100%;" class="uk-inline">
                        <span style="color: #000;" class="uk-form-icon" uk-icon="icon: pencil"></span>
                        <input v-model="name" style="width:100%; border-radius: 4px;" class="normal-txt uk-input"
                            type="text" placeholder="Subchannel Name" aria-label="Input">
                    </div>
                    <div v-if="validateNameError != ''" style="margin-top:10px;">
                        <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;"
                                uk-icon="icon: warning;"></span> {{ validateNameError }} </span>
                    </div>

                </div>
                <div style="padding: 10px; margin-top:5px;">
                    <div style="width:100%;" class="uk-inline">
                        <textarea v-model="description" class="uk-textarea normal-txt" rows="5" placeholder="Description"
                            aria-label="Textarea"></textarea>
                    </div>
                    <div v-if="validateDescError != ''" style="margin-top:10px;">
                        <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;"
                                uk-icon="icon: warning;"></span> {{ validateDescError }}</span>
                    </div>
                    <br /> <br />
                    <span class="normal-txt" style="font-weight: 500;">
                        Subchannel creation fees: {{ subchannelRegistrationFees }} FFG
                    </span>
                </div>

                <div style="padding: 10px; margin-top:5px;">
                    <button v-if="!creatingSubChannel && !subChannelCreated" @click="createSubChannel"
                        class="uk-button ffg-button"
                        style="font-weight: bold; text-transform: none; width:100%; height:50px;">
                        Create Sub-channel
                        <span class="uk-icon" uk-icon="icon: thumbnails"></span>
                    </button>
                    <div style="text-align:center;" v-if="creatingSubChannel">
                        <span style="color:#3e15ca;" class="uk-margin-small-right" uk-spinner="ratio: 1"></span>
                    </div>

                    <div style="text-align:center;" v-if="subChannelCreated">
                        Subchannel was successfully created
                    </div>

                    <br />
                    <div v-if="createSubChannelError != ''" style="margin-top:10px;">
                        <span class="uk-text-small uk-text-danger"> <span style="margin-right:5px;"
                                uk-icon="icon: warning;"></span> {{ createSubChannelError }} </span>
                    </div>
                </div>
            </div>
        </div>


        <div id="modal-upload" uk-modal="container:#node-container; esc-close:false; bg-close:false; ">
            <div style="padding-top:17px; width:60%; padding-bottom: 20px;" class="uk-modal-dialog uk-modal-body">
                <button id="close-modal-create" class="uk-modal-close-default" type="button" uk-close></button>
                <h2 class="modal-header">Upload to Channel</h2>
                <div style="padding: 10px; margin-top:10px;">
                    <uploader-component :callback="reload" :parent="node.node_hash" place="channel" />
                </div>
            </div>
        </div>

    </div>
</template>
        
<script>
// const { ipcRenderer } = window.require("electron");
import axios from 'axios';
import { globalState, SetEntryCreationMode } from '../../store';
import { ref } from 'vue';
import { Units } from "../../unit.js"
import BigNumber from 'bignumber.js';
import Pagination from "../../pagination.js";
import { callJsonRpc2Endpoint } from '../../rpc'
import numberToBN from "number-to-bn";
import { QuillEditor } from '@vueup/vue-quill'
import UploaderComponent from '../UploaderComponent.vue'
import '@vueup/vue-quill/dist/vue-quill.snow.css';
import ftype from "../../filetype";

export default {
    components: {
        QuillEditor,
        UploaderComponent
    },
    data() {
        return {
            createEntryError: "",
            creatingEntry: false,
            validateEntryNameError: "",
            entryName: "",
            folder_name: "",
            validateFolderNameError: "",
            creatingFolder: false,
            folderCreated: false,
            createFolderError: "",
            toolbarOptions: {
                modules: {
                    toolbar: [
                        ["bold", "italic", "underline", "strike"], // toggled buttons
                        ["blockquote", "code-block"],

                        [{ header: 1 }, { header: 2 }], // custom button values
                        [{ list: "ordered" }, { list: "bullet" }],
                        [{ script: "sub" }, { script: "super" }], // superscript/subscript
                        [{ indent: "-1" }, { indent: "+1" }], // outdent/indent
                        [{ direction: "rtl" }], // text direction

                        [{ size: ["small", false, "large", "huge"] }], // custom dropdown
                        [{ header: [1, 2, 3, 4, 5, 6, false] }],

                        [{ color: [] }, { background: [] }], // dropdown with defaults from theme
                        [{ font: [] }],
                        [{ align: [] }],

                        ["clean"], // remove formatting button
                    ],
                },
            },
            entry_content: "",
            subchannels: [],
            otherChannelNodes: [],
            subChannelCreated: false,
            lastTXSent: "",
            name: "",
            description: "",
            validateNameError: "",
            validateDescError: "",
            createSubChannelError: "",
            creatingSubChannel: false,
            node: { name: "", node_type: 0, node_hash: "", nodes: [], owner: "" },
            loadingNode: false,
            page_size: "1000",
            nodeAddress: "",
            colors: [
                "#3e15ca",
                "#f0506e",
                "#32d296",
                "#ff6200",
                "#00cca6",
                "#4947ef",
                "#bdbdbd",
            ],
            channels: []
        }
    },
    computed: {
        canCreate() {
            return this.node.owner == this.nodeAddress;
        },
        entryMode() {
            const mode = ref(globalState.entryCreationMode);
            return mode.value
        },
        globalState() {
            return globalState
        },
        subchannelRegistrationFees() {
            let feedBig = new BigNumber(this.globalState.remaining_channel_operation_fees_miliffg_hex, 16);
            let ffgFees = Units.convert(feedBig.toString(10), "FFGOne", "FFG")
            return ffgFees
        }
    },
    watch: {
        $route: async function (val) {
            if (val && val.name == "ChannelNode") {
                const req = {
                    originalUrl: "",
                    query: {
                        include_metadata: "true",
                        per_page: this.page_size,
                        page: val.query.page,
                    },
                };

                await this.getData(req);
            }
        },
    },
    unmounted() {

    },
    async mounted() {
        SetEntryCreationMode(false);
        const addr = ref(globalState.nodeAddress);
        if (addr.value != "") {
            this.nodeAddress = addr.value;
        }

        let page = this.$route.query.page || 1;
        const req = {
            originalUrl: "",
            query: {
                include_metadata: "true",
                per_page: this.page_size,
                page: page,
            },
        };

        await this.getData(req);
    },
    methods: {
        async reload() {
            let page = this.$route.query.page || 1;
            const req = {
                originalUrl: "",
                query: {
                    include_metadata: "true",
                    per_page: this.page_size,
                    page: page,
                },
            };

            await this.getData(req);
        },
        goBack() {
           SetEntryCreationMode(false);
        },
        openEntryModal() {
            SetEntryCreationMode(true);
        },
        nodeVector(name) {
            let img = `/assets/file_types/${ftype.getVectorOf(ftype.getExt(name))}.svg`;
            return img;
        },
        hideNav() {
            window.UIkit.dropdown(document.getElementById("new_dropdown")).hide();
        },
        async createEntry() {
            try {
                if (this.creatingEntry) {
                    return;
                }

                if (this.entryName == "") {
                    this.validateEntryNameError = "Entry name is required";
                    return;
                } else {
                    this.validateEntryNameError = "";
                }

               

                this.creatingEntry = true;

                this.createEntryError = "";

                const data = {
                    jsonrpc: '2.0',
                    method: "channel.CreateNodeItemsTxDataPayload",
                    params: [{ nodes: [{ parent_hash: this.node.node_hash, enabled: true, description: this.entry_content, name: this.entryName, node_type: 3, timestamp: Math.floor(Date.now() / 1000) }] }],
                    id: 1
                };

                const endpoint = ref(globalState.rpcEndpoint);
                const response = await axios.post(endpoint.value, data);

                let channelFees = numberToBN(response.data.result.total_fees_required);
                let balanceRes = await this.getBalance();
                let balanceFFGOneBig = numberToBN(balanceRes.balance_hex);
                if (balanceFFGOneBig.lt(channelFees)) {
                    throw new Error(
                        `You don't have enough coins in your balance!`
                    );
                }
                const jwtAccess = ref(globalState.jwtAccessToken);
                console.log(jwtAccess, callJsonRpc2Endpoint)
                const sendTxRes = await callJsonRpc2Endpoint("transaction.SendTransaction", [{ access_token: jwtAccess.value, nounce: balanceRes.next_nounce, data: response.data.result.transaction_data_payload_hex, from: this.nodeAddress, to: "0x01", value: "0x0", transaction_fees: response.data.result.total_fees_required }])
                this.lastTXSent = sendTxRes.data.result.transaction.hash


                let tries = 0;
                let loadTxInterval = setInterval(async() => {
                    if(tries > 21) {
                        this.createEntryError = "It seems like there was an error sending your transaction. Please reload the page to see if your entry was created.";
                        this.creatingEntry = false;
                        clearInterval(loadTxInterval);
                        return
                    }
                    tries++;
                    let res = await this.getTransaction(this.lastTXSent)
                    if(res.transactions && res.transactions.length > 0) {
                        this.creatingEntry = false;
                        clearInterval(loadTxInterval);
                        await this.reload()
                        SetEntryCreationMode(false);
                        this.entryName = "";
                        this.entry_content = "";
                        return
                    }
                }, 2000)


            } catch (e) {
                this.createEntryError = e.message;
                this.creatingEntry = false;
            }
        },
        async createNewFolder() {
            try {
                if (this.creatingFolder) {
                    return;
                }

                if (this.folder_name == "") {
                    this.validateFolderNameError = "Folder name is required";
                    return;
                } else {
                    this.validateFolderNameError = "";
                }

               

                this.creatingFolder = true;

                this.createFolderError = "";

                const data = {
                    jsonrpc: '2.0',
                    method: "channel.CreateNodeItemsTxDataPayload",
                    params: [{ nodes: [{ parent_hash: this.node.node_hash, enabled: true, name: this.folder_name, node_type: 4, timestamp: Math.floor(Date.now() / 1000) }] }],
                    id: 1
                };

                const endpoint = ref(globalState.rpcEndpoint);
                const response = await axios.post(endpoint.value, data);

                let channelFees = numberToBN(response.data.result.total_fees_required);
                let balanceRes = await this.getBalance();
                let balanceFFGOneBig = numberToBN(balanceRes.balance_hex);
                if (balanceFFGOneBig.lt(channelFees)) {
                    throw new Error(
                        `You don't have enough coins in your balance!`
                    );
                }
                const jwtAccess = ref(globalState.jwtAccessToken);
                const sendTxRes = await callJsonRpc2Endpoint("transaction.SendTransaction", [{ access_token: jwtAccess.value, nounce: balanceRes.next_nounce, data: response.data.result.transaction_data_payload_hex, from: this.nodeAddress, to: "0x01", value: "0x0", transaction_fees: response.data.result.total_fees_required }])
                this.lastTXSent = sendTxRes.data.result.transaction.hash

                let tries = 0;
                let loadTxInterval = setInterval(async() => {
                    if(tries > 21) {
                        this.createFolderError = "It seems like there was an error sending your transaction. Please reload the page to see if your subchannel was created.";
                        this.creatingFolder = false;
                        clearInterval(loadTxInterval);
                        return
                    }
                    tries++;
                    let res = await this.getTransaction(this.lastTXSent)
                    if(res.transactions && res.transactions.length > 0) {
                        this.folderCreated = true;
                        this.creatingFolder = false;
                        clearInterval(loadTxInterval);
                        await this.reload()
                        this.closeNewFolderModal()
                        return
                    }
                }, 2000)

            } catch (e) {
                this.createFolderError = e.message;
                this.creatingFolder = false;
            }
        },
        async createSubChannel() {
            try {
                if (this.creatingSubChannel) {
                    return;
                }

                if (this.name == "") {
                    this.validateNameError = "Channel name is required";
                    return;
                } else {
                    this.validateNameError = "";
                }

                if (this.description == "") {
                    this.validateDescError = "Channel description is required";
                    return;
                } else {
                    this.validateDescError = "";
                }

                this.creatingSubChannel = true;

                this.createSubChannelError = "";

                const data = {
                    jsonrpc: '2.0',
                    method: "channel.CreateNodeItemsTxDataPayload",
                    params: [{ nodes: [{ parent_hash: this.node.node_hash, enabled: true, name: this.name, description: this.description, node_type: 2, timestamp: Math.floor(Date.now() / 1000) }] }],
                    id: 1
                };

                const endpoint = ref(globalState.rpcEndpoint);
                const response = await axios.post(endpoint.value, data);

                let channelFees = numberToBN(response.data.result.total_fees_required);
                let balanceRes = await this.getBalance();
                let balanceFFGOneBig = numberToBN(balanceRes.balance_hex);
                if (balanceFFGOneBig.lt(channelFees)) {
                    throw new Error(
                        `You don't have enough coins in your balance!`
                    );
                }
                const jwtAccess = ref(globalState.jwtAccessToken);
                const sendTxRes = await callJsonRpc2Endpoint("transaction.SendTransaction", [{ access_token: jwtAccess.value, nounce: balanceRes.next_nounce, data: response.data.result.transaction_data_payload_hex, from: this.nodeAddress, to: "0x01", value: "0x0", transaction_fees: response.data.result.total_fees_required }])
                this.lastTXSent = sendTxRes.data.result.transaction.hash
                

                let tries = 0;
                let loadTxInterval = setInterval(async() => {
                    if(tries > 21) {
                        this.createSubChannelError = "It seems like there was an error sending your transaction. Please reload the page to see if your subchannel was created.";
                        this.creatingSubChannel = false;
                        clearInterval(loadTxInterval);
                        return
                    }
                    tries++;
                    let res = await this.getTransaction(this.lastTXSent)
                    if(res.transactions && res.transactions.length > 0) {
                        this.subChannelCreated = true;
                        this.creatingSubChannel = false;
                        clearInterval(loadTxInterval);
                        await this.reload()
                        this.closeCreateSubChannelModal()
                        return
                    }
                }, 2000)

            } catch (e) {
                this.createSubChannelError = e.message;
                this.creatingSubChannel = false;
            } 
        },
        async getTransaction(hash) {
            const data = {
                jsonrpc: '2.0',
                method: "transaction.Receipt",
                params: [{ hash: hash}],
                id: 1
            };
            const endpoint = ref(globalState.rpcEndpoint);
            const response = await axios.post(endpoint.value, data);
            return response.data.result;
        },
        async getData(req) {
            const paginator = new Pagination.Pagination(req);
            const paginationParams = paginator.extractPaginationData();
            this.loadingNode = true;
            try {
                const res = await this.getNode(
                    this.$route.params.hash,
                    parseInt(req.query.page) - 1,
                    paginationParams.limit
                );

                if (res.node && res.node != null) {
                    let subChannels = res.node.nodes.filter(item => item.node_type == 2)
                    let otherEntries = res.node.nodes.filter(item => item.node_type > 2)
                    this.subchannels = subChannels;
                    this.otherChannelNodes = otherEntries;

                    this.node = res.node;

                }

                paginator.paginate({ rows: this.node.nodes, count: res.total });
                let pl = paginator.payload();
                this.pagination = { ...pl };
            } catch (e) {
                // this.loadingChannelError = true;
                alert(e.message);
            } finally {
                this.loadingNode = false;
            }
        },
        async getNode(nodeHash, currentPage, pageSize) {
            const data = {
                jsonrpc: '2.0',
                method: "channel.GetNodeItem",
                params: [{ node_hash: nodeHash, current_page: currentPage, page_size: pageSize, order: "asc" }],
                id: 1
            };

            let endpoint = ref(globalState.rpcEndpoint);
            let response = await axios.post(endpoint.value, data);
            return response.data.result;
        },
        async getBalance() {
            const data = {
                jsonrpc: '2.0',
                method: "address.Balance",
                params: [{ address: this.nodeAddress }],
                id: 1
            };
            const endpoint = ref(globalState.rpcEndpoint);
            const response = await axios.post(endpoint.value, data);
            return response.data.result;
        },
        getBgColor(idx) {
            let which = idx % this.colors.length
            return this.colors[which];
        },
        openUploadModal() {
            const myModal = document.getElementById('modal-upload');
            const modal = window.UIkit.modal(myModal);
            modal.show();
        },
        closeUploadModal() {
            const myModal = document.getElementById('modal-upload');
            const modal = window.UIkit.modal(myModal);
            modal.hide();
        },
        openCreateSubChannelModal() {
            this.subChannelCreated = false;
            const myModal = document.getElementById('modal-createsubchannel');
            const modal = window.UIkit.modal(myModal);
            modal.show();
        },
        closeCreateSubChannelModal() {
            const myModal = document.getElementById('modal-createsubchannel');
            const modal = window.UIkit.modal(myModal);
            modal.hide();
        },
        openNewFolderModal() {
            this.subChannelCreated = false;
            const myModal = document.getElementById('modal-newfolder');
            const modal = window.UIkit.modal(myModal);
            modal.show();
        },
        closeNewFolderModal() {
            const myModal = document.getElementById('modal-newfolder');
            const modal = window.UIkit.modal(myModal);
            modal.hide();
        },
    }
}
</script>

<style scoped>
</style>
